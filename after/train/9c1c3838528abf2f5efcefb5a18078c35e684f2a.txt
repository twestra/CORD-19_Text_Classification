Background: Mounting evidence suggests that there is an undetected pool of COVID-19 asymptomatic but infectious cases. Estimating the number of asymptomatic infections has been crucial to understand the virus and contain its spread, which is, however, hard to be accurately counted.
Methods: We propose an approach of machine learning based fine-grained simulator (ML-Sim), which integrates multiple practical factors including disease progress in the incubation period, cross-region population movement, undetected asymptomatic patients, and prevention and containment strength. The interactions among these factors are modeled by virtual transmission dynamics with several undetermined parameters, which are determined from epidemic data by machine learning techniques. When MLSim learns to match the real data closely, it also models the number of asymptomatic patients. MLSim is learned from the open Chinese global epidemic data.
Findings: MLSim showed better forecast accuracy than the SEIR and LSTM-based prediction models. The MLSim learned from the data of China's mainland reveals that there could have been 150,408 (142,178-157,417) asymptomatic and had self-healed patients, which is 65% (64% -65%) of the inferred total infections including undetected ones. The numbers of asymptomatic but infectious patients on April 15, 2020, were inferred as, 215 -171,930). To control the virus transmission, the containment measures taken by the government were crucial. The learned MLSim also reveals that if the date of containment measures in China's mainland was postponed for 1, 3, 5, and 7 days later than Jan. 23, there would be 109,039 (129%), 183,930 (218%), 313,342 (371%), 537,555 (637%) confirmed cases on June 12.
Conclusions: Machine learning based fine-grained simulators can better model the complex real-world disease transmission process, and thus can help decision-making of balanced containment measures. The simulator also revealed the potential great number of undetected asymptomatic infections, which poses a great risk to the virus containment. , is a coronavirus and belongs to the same family as the pathogen that causes severe acute respiratory syndrome (ARDS), or SARS [Li et al., 2020; Zhou et al., 2020] . It causes a respiratory dominated illness and can spread from person to person [Chan et al., 2020; Wang et al., 2020b; Xu et al., 2020].
Asymptomatic cases refer to people who can be tested positive for the coronavirus but develop limited or no symptoms such as fever, cough, or sore throat, noting that they are infectious and pose a risk of spreading to others. Mounting evidence suggests that there is an undetected pool of covert asymptomatic cases [Dong et al., 2020; Wang et al., 2020a]. A recent news [Qiu] published by Nature on March 20, 2020, manifests that there could be 30% -60% patients are asymptomatic or mildly ill cases. Estimating the number of undetected asymptomatic cases has been crucial to containing the spread of the coronavirus, which is, however, hard to be accurately counted. Meanwhile, if we can model how the virus transmits, it is fully possible to make inference on the unobserved number of asymptomatic patients from the observed epidemic data.
There are mainly two ways to model the virus transmission. One way is to employ transmission dynamics to describe how diseases spread. A classical transmission dynamics model is the Susceptible Infected Recovered (SIR) model [Kermack and McKendrick, 1991] that consists of susceptibles, infectives, and recovered individuals, and differential equations about how individuals changes. Variants of SIR models have been studied, such as the SEIR model [Anderson et al., 1992; Lekone and Finkenstädt, 2006] considering the incubation period, which is also significant for COVID-19 infection, and other models considering temporary immunity [Wen and Yang, 2008], passive immunity [Bichara et al., 2014; Qureshi and Yusuf, 2019], etc. These models are grounded in human knowledge about virus infection and immunity, which are good in generalization to long-period predictions. At the same time, these models commonly over-simply the real-world and are hard to fit well the epidemic data, which results in large prediction errors. Another way is to rely on machine learning models. For epidemic data, a type of model that are naturally suitable for the task is the recurrent neural networks (RNNs) [Elman, 1990] , with long short-term memory (LSTM) [Hochreiter and Schmidhuber, 1997] . These models are very flexible that can fit well the epidemic data, and thus can make accurate predictions for the very near future. However, due to the lack of domain knowledge, these models are hard to generalize to long-term futures, hard to incorporate different decisions, and hard to be interpretable.
Noticed that combination of human knowledge and learning from data has recently shown powerful in solving sophisticated problems [Zhou, 2019]. To alleviate the above issues of the two types of methods, we propose an approach of machine learning based fine-grained simulator (MLSim), which can not only predict the virus transmission more accurately, but also help to estimate the number of asymptomatic patients.
We propose a machine learning based transmission simulator (MLSim) to estimate COVID-19 asymptomatic infections. MLSim is data-driven and integrates multiple crucial factors, including disease progress in the incubation period, cross-region population movement, undetected asymp-2 . CC-BY-NC 4.0 International license It is made available under a is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity. (which was not certified by peer review)
The infections in MLSim are divided into latent, quarantined, and confirmed patients. Only latent patients have the ability to infect others. Each kind of patients can experience a period of time to move to the next stage. Latent patients can show obvious symptoms and be quarantined with the probability of σ on any day of 14 days, which is the time of the incubation period. The latent patients who have experienced the whole incubation period and are not quarantined are usually mildly ill or asymptomatic. We assume these patients will self-heal. The self-healed patients were not recorded in the published data, and calculating their number can help to estimate the number of asymptomatic patients. See Appendix A for more explanations of why self-healed patients are essential. The parameters in MLSim are learned through derivative-free optimization since the simulator is non-differential.
The simulator structure, which is designed according to the transmission characteristics of COVID-19, is shown in Figure 1 . The disease progress is divided into three stages: incubation stage, quarantine stage, and confirmation stage. All three stages are represented as fixed-length lists, whose length is determined by the clinical experience. Each number in the list indicates the number of patients on that day. The patients in these stages are respectively called latent patients, quarantined patients, and confirmed patients. Latent patients are infectious and temporarily mildly ill or asymptomatic. Once they show obvious symptoms, they will be quarantined and lose the infectivity.
In each day, the susceptible populations can be infected and turned into latent patients. Meanwhile, the external latent patients can infect other passengers through the cross-region population movement. The number of newly infected patients will be appended as the first day in the latent patient list, and thus the number of patients each day in the list automatically moves to the next day. Then, the number on the last day of the list will be removed, which means the patients that the number represents have experienced the whole incubation stage, i.e., 14 days, without showing obvious symptoms and being quarantined. They are assumed to be self-healed. The latent patients can show obvious symptoms and be quarantined on any day of the incubation stage. The quarantined patients will be confirmed according to the diagnostic rate on any day of the quarantine stage or when they are moved out of the list. It should be noticed that latent patients may not be quarantined, but all quarantined patients will be confirmed. The mortality/recovery rate represents the probability of death/recovery per day. If the confirmed patients have experienced the whole confirmation stage, i.e., 25 days, they are assumed to have recovered.
To finalize the simulator, we need to determine the parameters. Our goal is to find the parameters that make the simulation outcome as similar as possible with the real epidemic data. In the following parts, we introduce the parameters to be optimized, the loss function, and the optimization process.
We initialize the simulator by setting S[0] = N (N is the population of the region), Q[0] = 0 and C[0] = 0. We have 8 parameters to be optimized, respectively are β, k k , σ, γ, θ, δ and I(0). The start date of the simulator was 14 days before the date when the epidemic data was first released. Because the real number of latent patients on that day is unavailable, we leave it to be optimized (I[0]). We assume the average number of individual contacts per person per day before containment is 15. k represents the average number of individual contacts within a region after the containment. k represents the average number of individual contacts in the cross-region population movement after the containment. 15/k and 15/k reflect the government's containment strength. A smaller k indicates a higher containment strength. The explanation of other parameters is the same as that of Figure 1 .C.
Let the difference between the real number of newly confirmed cases on the t th day and its simulated counterpart be ∆N c [t] . Analogously, let the difference between the real number of new deaths and its simulated counterpart on the t th day be ∆N d [t] and the difference between the real number of new recoveries and its simulated counterpart on the t th day be ∆N r [t] . Then the loss function, which maximizes the utilization of all public data, is defined as:
Since the rules of the simulator are non-differentiable, the parameters can not be optimized through derivative-based methods, e.g., stochastic gradient descent.
Derivative-free optimization, also termed as zeroth-order or black-box optimization, involves a class of optimization algorithms that do not rely on gradient information. Typical derivativefree optimization algorithms include evolutionary algorithms [Hansen et al., 2003; Larrañaga and Lozano, 2001; Neumann and Wegener, 2007] , Bayesian optimization [Kawaguchi et al., 2015; Martinez-Cantin, 2014; Wang et al., 2016] and recently emerged classification-based optimization methods [Hu et al., 2017; Liu et al., 2019; Yu et al., 2016] . ZOOpt [Liu et al., 2018] is a python package for derivative-free optimization. It implements some state-of-the-art classification-based derivative-free optimization methods and their parallel versions, which can quickly approximate the optimal solution to the problem. We used ZOOpt to obtain the parameters that minimize the loss function.
The funder of the study had no role in method design, data collection, data analysis, data interpretation, or writing of this article.
This section evaluates the validation of the MLSim approach.
The most recent epidemic data based on daily COVID-19 outbreak numbers were retrieved from two open-source GitHub repositories, which respectively share the Chinese epidemic data 1 and the global epidemic data 2 . The abrupt increase of confirmed cases in China on Feb. 13 is exponentially averaged onto the numbers in the previous 32 days. The population movement data in China's mainland were sourced from baiduqianxi 3 , which gives the migration index based on the daily number of inbound and outbound events by rail, air, and road traffic.
. CC-BY-NC 4.0 International license It is made available under a is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity. (which was not certified by peer review)
The copyright holder for this preprint this version posted April 23, 2020 . . https://doi.org/10.1101 
We first tested the prediction accuracy of MLSim and compared it with the SEIR and LSTMbased model.
The COVID-19 data of China was divided into two parts. The first part, the training data, included the data before Feb. 10, 2020. And the second part, the validation data, included the rest. The start date of the simulator was set to be Dec. 28, 2019. The number of inflowing (outflowing) patients can be calculated as N io N l N , where N io is the inflowing (outflowing) population size, N l is the number of latent patients in the source region and N is the population of the source region.
We constructed a simulator for each China province. The simulator parameters of Hubei were first optimized, where the inflowing patients from the remaining provinces were not considered. Because k · I in [t] was always equal to 0, the parameter k , average individual contacts in the crossregion population movement, was not optimized. Then we fixed the parameters of Hubei and separately optimized the parameters of the remaining China provinces, which only considered the inflowing patients from Hubei. The parameters of the SEIR and LSTM model were obtained by fitting the training data, i.e., minimizing the mean square error between the predicted results and the real data. Details of the training can be found in Appendix B and Appendix C.
Models were also trained on the data of South Korea. The training data included the data before Mar. 5, and the validation data included the rest. The COVID-19 data of China was added for training the LSTM model.
The results are shown in Figure 2 . It can be observed that MLSim achieved the best validation performance in all cases. Notice that the training data of Hubei has not shown an evident decline yet. The LSTM model gave a constant prediction. In Figure 2 -D, the curve generated by the LSTM model shows a periodic characteristic. The curve generated by the LSTM model in Figure 2 -F is similar to the training data of China, which shows that a small increase of training data cannot help LSTM learn something essential but only makes it remember more data. The generalization performance of the SEIR model is worse than that of MLSim in all cases.
The above results demonstrate that MLSim can forecast virus transmission more accurately. The SEIR model is much simpler, which leads to a comparatively weak representation ability. Neural networks like LSTM have strong representation ability, but it can only predict the near future for the lack of domain knowledge and suffers from the overfitting problems when the amount of available data is limited.
We obtained the simulator parameters of 31 China provinces and 6 other countries by fitting the data. The optimization was repeated 10 times, and for each parameter, the median value and its 95% confidence interval are recorded. Here we discuss the results of Hubei. The results of other provinces and countries can be found in Appendix F. For Hubei, the infection rate β, i.e. the rate of transmission for the susceptible to be infected, is 0.023 (0.018-0.027) and the quarantine rate σ, i.e. the rate by which the latent patients develops obvious symptoms and are quarantined per day, is 0.030 (0.030-0.031). The initial number of infected patients on Dec. 28, 2019 is 106 (29-397). The average individual contacts has decreased by 87% (83%-90%) (calculated by 1 − k/15) since Jan. 23, 2020, the start date of containment in China. The reproductive number, which means the number of cases one case generates on average over the course of its infectious period, can be calculated as 14 n=1 kβ(1 − σ) n , where k is the average number of individual contacts, 14 is the maximum length of incubation period set in our simulator. The reproductive number before and after the containment are respectively equal to 3.850 (3.083-4.595) (R 0 ) and 0.499 (0.489-0.520) (R 0 ). Ignoring the self-healed patients, the epidemic doubling time in the early stage can be calculated as 1/ log 2 (1 + kβ(1 − σ)), which is equal to 2.625 (2.217-3.267) days. The obtained doubling time is shorter than that estimated in some previous work [Kucharski et al., 2020; Wu et al., 2020a,b] because we considered the undetected patients in this paper.
MLSim assumes that latent infections are currently asymptomatic and if they don't show obvious symptoms and be quarantined in the whole incubation period, they will self-heal. Figure 3 shows the simulated results of MLSim. We found that only 35% (35%-36%) infections were detected in China and 65% (64%-65%) infections were asymptomatic and had self-healed. The current numbers of latent patients in South Korea, Italy, Germany, USA and UK respectively are 112 (40-262), 41,387 (29,037-57,151), 21,118 (11,484-41,646), 354,657 (277,641-495,128), 144,424 (127,215-171,930) , posing a great risk to the virus containment.
The Chinese government has carried out strict prevention and containment measures since Jan. 23, 2020 [Cao and Zhou; Paul Mozur and Krolik] , which have effectively controlled the virus spread but caused inevitable economical loss [The Economist] . What if the measures were not taken? We use the optimized simulator to find the answer. We simulated the virus transmission retrospectively with different containment start dates and containment-strengths.
We first postponed the start date of containment. The simulation results are shown in Figure  4 , which demonstrate that there would be 109,039 (129%), 183,930 (218%), 313,342 (371%), 537,555 (637%) confirmed cases on June 12 if the start date of containment was postponed by 1, 3, 5 or 7 days.
The prevention and containment measures will directly change the value of k, i.e. the average number of individual contacts. A greater containment-strength causes a smaller k. Therefore, the containment-strength can be relaxed by increasing k value while leaving other parameters unchanged. We increased k by 30%, 60%, 90% on Jan. 23 and by 60%, 90%, 110% on March 1 respectively to investigate their influence. It can be observed that if k was increased by 30% on Jan. 23, the cumulative number of confirmed cases would increased to 111,460 (132%) on June 12. If k was increased by 60% on Jan. 23, the cumulative number of confirmed cases would increase to 176,053 (209%). Compared with that, the influence of relaxing the containment after March 1 is much less. An increase of k by 60% causes 3,296 (4%) more confirmed cases. While an increase of k by 110% will cause a second outbreak.
Through this retrospective simulation, we conclude that the strict containment measures taken after Jan. 23 are crucial for suppressing the virus spread and a postponement of few days or slight relaxation of containment strength on that day may cause much more confirmed cases. Comparatively, an appropriate relaxation (60%) of the containment on March 1 can benefit the national economy with few adverse effects. But a great relaxation (110%) on March 1 can still cause a second outbreak.
8 . CC-BY-NC 4.0 International license It is made available under a is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
The copyright holder for this preprint this version posted April 23, 2020. 
Figure 3: Estimate the number of asymptomatic cases. MLSim assumes that latent infections are currently mildly ill or asymptomatic. If they don't develop obvious symptoms and be quarantined in the whole incubation period, they will self-heal. The number of total infections is the sum of the number of confirmed, quarantined, latent and self-healed cases. The abrupt decrease of the number of new infections in countries except UK is due to the learned average individual contacts after containment (k). For UK, k was not optimized because the data were not sufficient enough to estimate the influence of containment accurately. Panel G shows the number of different kinds of infections on April 15.
The COVID-19 infections data indicates the epidemic in China's mainland is close to an end. However, the trend in global is currently climbing. Here, we forecast the virus transmission in some countries (the obtained simulator parameters are shown in Appendix F). Inflowing patients were not considered in this experiment and its effect was transformed to the number of initial infections on Jan. 9, 2020, due to the lack of the global population movement data.
. CC-BY-NC 4.0 International license It is made available under a is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
The copyright holder for this preprint this version posted April 23, 2020. .
For countries except UK, the average individual contacts after the containment (k) can be learned by fitting the data. We forecast the virus transmission in these countries by keeping simulator parameters unchanged. While for UK, k cannot be learned accurately because the current data is not sufficient enough. Instead, we assumed k = 15 all along and forecast the future by decreasing k to different values. Results are shown in Figure 5 . There could be 10,536 (10,051 -11,601), 195,000 (183,770 -247,865), 166,258 (163,497 -171,316), 1,033,717 (994,147 -1,120,326) and 478,117 (323,082 -581,761) confirmed cases in South Korea, Italy, Germany, USA and France on July 15. For UK, if the containment measures were not taken, there could be 30 millions (25m-34m) confirmed cases on July 15, which means 44% (37% -50%) populations will get infected. Jan. 23 Jan. 24 Jan. 26 Jan. 28 Jan. 30 Confirmed
E. The number of infections on June 12 if the containment was weaken January 23.
F. The number of infections on June 12 if the containment was weaken on March 1. Legends in panel A denote the start date of the containment. If the containment was weakened, the average individual contacts after the containment (k) will increase. Legends in panel B and C and percentages in the first line of table E and F denote how much k was increased to if the containment was weakened on Jan. 23 and Mar. 1.
. CC-BY-NC 4.0 International license It is made available under a is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
The copyright holder for this preprint this version posted April 23, 2020. .
South 
. CC-BY-NC 4.0 International license It is made available under a is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
The copyright holder for this preprint this version posted April 23, 2020. . https://doi.org/10. 1101 Traditional virus transmission models usually make more assumptions than MLSim and left only few parameters to be determined. For example, SEIR model had to assume the number of initial patients, incubation period and the change of average contacts after the containment in advance to determine the infection rate or R 0 . Although these assumptions are mostly based on clinical experience, fixing these parameters to a certain value can still be very subjective. Instead of fixing these parameters, MLSim only assumed the maximum length of each disease stage and moderately limited the search space of the parameters, rather than fixing these parameters to a certain value. Having more parameters to be optimized enables MLSim a better representation ability than traditional models. However, it also causes a side effect: there could be a multi-solution problem, in another word, there could be more than one set of simulator parameters that can fit the data and some parameters might be unreasonable. There is actually a trade-off here: the more strict the assumptions, e.g. fixing parameters to one value, the less likely the multi-solution problems could happen and the poorer representation ability the model has. An appropriate limitation on the search space of parameters can benefit the model with sufficient representation ability and fewer unreasonable solutions. Appendix D shows the settings of the search space of parameters in all experiments. In general, the multi-solution problem exists but can be eliminated by introducing more domain knowledge, i.e. more strict assumptions.
There are other potentially important factors we did not consider in our simulator, mainly due to the lack of data. The factors can include the capacity of daily tests of infections, which upper bounds the daily maximum confirmation number, and the ICU capacity, which directly affects the death rate.
In this paper, we proposed a machine learning based fine-grained simulator (MLSim), which built a simulator from expert domain knowledge together with learning from data. We applied MLSim to COVID-19 data and the obtained parameters can reflect its transmission characteristics. The empirical studies showed that MLSim not only can have a better long-term prediction accuracy, but can also help to estimate the number of asymptomatic infections. This kind of hybrid knowledge and data learning approach was not widely recognized in machine learning community. But we found it very useful when the data is scarce while knowledge is rich but inaccurate, such as the situation of a new contagion outbreak.
We thank Mr. Su Lu, Mr. Xin-Chun Li and Mr. Hong-Wei Wei for providing baseline implementations, and Mr. Chao Wang and Mr. Yu-Yang Huang for running a daily updating system of the proposed approach for a long-term validation.
12 . CC-BY-NC 4.0 International license It is made available under a is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
The copyright holder for this preprint this version posted April 23, 2020. 14 . CC-BY-NC 4.0 International license It is made available under a is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
The copyright holder for this preprint this version posted April 23, 2020. . https://doi.org/10.1101/2020.04.19.20068072 doi: medRxiv preprint
In this section, we try to find out if the setting of undetected asymptomatic patients is necessary. MLSim can estimate the ratio of undetected asymptomatic patients by computing (1 − σ) 14 , i.e., the number of self-healed patients, where σ is the quarantine rate. Theoretically, if the learned σ is large, the asymptomatic ratio will be low. For example, when σ is respectively equal to 0.1, 0.2 and 0.3, the asymptomatic ratio will be 23%, 4% and 0%. We limited the lower bound of the search space of σ to be 0.1, 0.2, 0.3 to see whether MLSim can still well fit the published data. The results are shown in Table 1 . Note that the obtained parameters for Hubei (0.1, 0.2, 0.3) are inaccurate because the quarantine rate is overestimated. It can be observed that the RMSE values of these optimizations are worse than those without lower bound limitations. The results indicate that undetected asymptomatic patients are necessary to fit the real data. Table 1 : The obtained parameters when limiting the number of asymptomatic patients. We limited the lower bound of the search space of σ, the quarantine rate, to be 0.1, 0.2, 0.3 to see whether MLSim can still well fit the published data. When σ is respectively equal to 0.1, 0.2 and 0.3, the asymptomatic ratio will be at most 23%, 4% and 0%. Note that the obtained parameters are inaccurate for Hubei (0.1, 0.2, 0.3) because the quarantine rate is overestimated.
. CC-BY-NC 4.0 International license It is made available under a is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
The copyright holder for this preprint this version posted April 23, 2020. 
The SEIR model consists of four compartments: S for the number of susceptible, E for the number of exposed, I for the number of infectious, and R for the number recovered (or immune) individuals. The dynamics is described by the following differential equations:
where β represents the rate of transmission for the susceptible to be infected; σ is the rate by which the exposed individual develops symptoms; γ is the probability of recovery or death; and N is the total population. In order to apply the SEIR model, we need to estimate the parameters β, σ, and γ. Because the incubation period of the COVID-19 has been reported to be between 2 to 14 days, we chose the midpoint of 7 days, and σ is set to be 1 7 . γ is the average rate of recovery or death in infected populations (i.e., γ = 1 D , where D is the average duration of the infection). According to the published clinical experience, we set D to be 14 and γ = 1 14 . The parameter β and the number of initial infections can be learned to fit the daily COVID-19 outbreak data. We assume that the value of β is reduced by 80% after Jan. 23 because of the containment. We assume the diagnostic period is 10 days, which means the number of new infections corresponds to the number of newly confirmed cases 10 days later.
The LSTM model implemented in this paper takes the number of newly confirmed cases in the previous three days as input, and output the number of newly confirmed cases in the next day. The architecture of the neural network is: Input(3) → FC(3,15) → Tanh → LSTM(15,15) → FC(15,1) → Tanh → output(1), where FC means a fully connected layer, tanh means tanh activation function and LSTM means an LSTM module.
An example was made by taking the previous three days' number of confirmed cases as the feature and this day's number as the label. All examples consisted the training set. The values in a feature were rescaled to [0, 1] by min-max normalization. In each training iteration, an episode of features was inputted, and the mean square error between the outputs and the labels were calculated. We used Adam to optimize the neural network parameters. The learning rate was set to be 0.001, and the neural network was optimized for 500 iterations. In the test phase, the current output of the model was used as the future input for the lack of real data.
. CC-BY-NC 4.0 International license It is made available under a is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
The copyright holder for this preprint this version posted April 23, 2020. .
Here, we list the parameter settings for the optimization in all experiments. We set the range of the parameter's search space to a reasonable range according to the prior knowledge. γ, the diagnostic rate per day, was upper bounded by 0.3. Considering the overall mortality rate of COVID-19 was no more than 20%, we upper-bounded δ, the mortality rate per day, by 1%. k , the average contacts per person per day after the containment, was bounded by 15, which is the average contacts before the containment. θ, the recovery rate per day of the confirmed cases, was bounded by 10% for China or 15% for other countries. I(0), the number of initial infections 14 days before the date when the epidemic data was first released, was bounded by 400 for Hubei, China, and other countries. I(0) was set to be 0 for other provinces in China because the initial infections in these provinces were from Hubei. If β is 0.1, the value of R 0 will be 9.16, which is far from the R 0 value determined by current literature. Thus, β of Hubei was upper bounded by 0.1. Budget, the number of evaluations the optimization algorithm can use, was set to be 200,000 for the optimization of parameters in Hubei. For other provinces and countries, the budget was set to be 80,000 to reduce the total training time.
For the remaining parameters, we first set their search space to a large and reasonable range. The range of σ, the quarantine rate per day, is set to be [0, 0.24]. The average contacts k after the containment was upper bounded by 15. We first optimized the parameters of Hubei. Then we further narrow down the search space according to the obtained parameters. For example, β was limited to [0, 0.5], and k was limited to [0, 5] . The ultimate search space of all parameters was shown in Table 2 . 18 . CC-BY-NC 4.0 International license It is made available under a is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
The copyright holder for this preprint this version posted April 23, 2020. . Table 3 : The simulated results of the number of all kinds of infections on April 15. The number of infections in China's mainland is the sum of infections in 31 provinces. The optimization was repeated for 10 times and the median and its confidence interval was recorded.
. CC-BY-NC 4.0 International license It is made available under a is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
The copyright holder for this preprint this version posted April 23, 2020. . Table 4 : Obtained parameters by fitting the COVID-19 data. For Chinese provinces, data before March 13 was used for training and for other countries, data before April 8 was used. Optimization were repeated for 10 times and the median and its confidence interval was recorded. β is the infection rate. k is the average number of contacts after containment. The average number of contacts is 15 before containment. γ is diagnostic rate per day. δ is the mortality rate per day.
. CC-BY-NC 4.0 International license It is made available under a is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
The copyright holder for this preprint this version posted April 23, 2020. . Table 4 . For Chinese provinces, I(0) is the number of initial infections on Dec. 28, 2019. For other countries, I(0) is the number of initial infections on Jan. 9, 2020. σ is the quarantine rate per day. k is the average number of contacts in the cross-region population movement. γ is diagnostic rate per day. θ is the recovery rate per day.
. CC-BY-NC 4.0 International license It is made available under a is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
The copyright holder for this preprint this version posted April 23, 2020 . . https://doi.org/10.1101 Table 6 : Obtained parameters by fitting the COVID-19 data. Follow Table 5 . RMSE is the root mean square error between the real data and the simulated results. R 0 and R 0 is the reproductive number before and after the containment. DT is the epidemic doubling time in the early stage, which ignores the self-healed patients.
. CC-BY-NC 4.0 International license It is made available under a is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
The copyright holder for this preprint this version posted April 23, 2020. Figure 6 : The comparison between the real (red) number of newly confirmed cases and the simulated (blue) results. It can be observed that MLSim can fit the real data well.
. CC-BY-NC 4.0 International license It is made available under a is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity. (which was not certified by peer review)
The copyright holder for this preprint this version posted April 23, 2020. . https://doi.org/10. 1101 
