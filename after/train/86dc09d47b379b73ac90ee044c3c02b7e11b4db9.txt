The COVID-19 pandemic has become the center of attention for both researchers and authorities. In this paper, we propose and test a methodology to estimate the daily effective reproduction number (R t ) through the lens of the Kalman Filter and Bayesian estimation. Moreover, we apply our method to data from the current COVID-19 pandemic in China, Italy, Japan, and South Korea. We correlate our findings with the implementation of control measures in each of these countries. Our results show that China, Italy, and South Korea have been able to reduce R t over time. We find significant heterogeneity in the way R t decreases across countries. For instance, China reduced R t from its peak to below one in 19 days, while South Korea achieved the same reduction in 12 days. In contrast, it has taken Italy almost a month to reach similar levels. We hypothesize this is related to how strict, enforceable, and comprehensive are the implemented policies.
By the time we are writing this paper, the COVID-19 outbreak has caused more than two million infections all around the world. 1 Most of the affected countries have established quarantine protocols to try to "flatten" the curve and keep their health systems afloat. 2 In this context, tracking the evolution of the pandemic under these policies has become a crucial matter for authorities. In this paper, we estimate the daily effective reproductive number (R t ) of COVID-19 using the Kalman filter and Bayesian estimation. Such analysis provides a real-time monitoring tool that can be useful to inform their public authorities, and help them improve their interventions. 3 Note: This table shows the median estimated R t for each country analyzed. The first row shows the average effective reproduction rate for the full time-series. The second row shows the estimation for the last day in the sample. The 90% posterior interval is shown in parenthesis.
Tracking the evolution of epidemic outbreaks is notoriously difficult. Human-contact dynamics, testing, model, and data reliance are factors constantly affecting the flow and the quality of the information available. Bayesian methods can partially overcome these challenges by continually updating the estimation as new information becomes available. Moreover, the use of the Kalman filter helps us to identify the evolution of the daily reproduction number accounting for the possibility of model error. 4, 5 The use of the Kalman filter to track the evolution of pandemics is not new. Other papers have done similar exercises for Ebola and AIDS/HIV. 6, 7 However, these were ex-post analysis, and to the best of our knowledge, this is the first real-time application of the method to COVID-19. With our approach, we provide a time-series for the estimated daily effective reproduction number for China, Italy, Japan, and Korea. ‡ The priors for our estimation come from previous studies on the reproduction number for COVID-19. 3, 8, 9 We test the accuracy of our method by evaluating its performance using simulated data. Table 1 summarizes some of our results. We find that China, Italy, and South Korea have been able to reduce R t over time. Figure 1 shows there is a strong correlation between the implementation of control measures and the decrease of R t . However, there is heterogeneity in the decreasing path of R t across countries. For instance, China reduced R t from its peak to below one in 19 days. South Korea achieved the same reduction in 12 days, and it has taken Italy almost a month to reach similar levels. In contrast, Japan is the only country among the four analyzed, which displays an increasing trend over time. We hypothesize this is probably due to the lack of strict containment/control policies.
We use publicly available data on total infections, active cases and recoveries. All the data comes from the European Center for Disease Control. 10 The database covers the period from December 31, 2019 to April 10, 2020. We define the first day of the outbreak as the day when total infections reach 100 or more people. Table 6 in appendix A.1 summarizes the starting date for each country. We smooth daily volatility by using a five-day centered moving average to the total number of infections. All data was normalized as number of cases per million people. Population data comes from the European Center for Disease Control and the U.S Census Bureau. 10,11
At the heart of our method lies a susceptible (S t ), infectious (I t ), and recovered (R t ) infection transmission model. Our main assumption is that conditional on the information available at time t, the daily effective reproduction number follows a martingale process and the innovations to the model are all Gaussian. This is an important assumption because: (1) If all the information is taken as given, we can borrow from the SIR model a single linear differential equation where R t is the only time-varying parameter; (2) If the model is linear and all noise is Gaussian, the Kalman filter will yield the best linear estimator for R t . Moreover, the underlying parameters needed to run the Kalman filter can be estimated using a Bayesian Gibbs sampling. ‡ From the SIR model (see appendix ?? for the complete model), the relationship between R t and the total number of infections is described by:
Where R t = βt γ , β t is transmission rate at any given time t, and γ is the rate of isolation. To implement the filter, we use the following state-space representation:
Whereî t = ∆I t+1 + γI t andŝ t = γS t I t . Equation (2) is called the observation equation and relates the unobserved state R t to the observable variablesî t andŝ t . The error term t accounts for the ‡ The Kalman filter is optimal in the sense that minimises the mean square error of the estimated parameters.
3 . CC-BY-NC-ND 4.0 International license It is made available under a is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity. (which was not certified by peer review)
The copyright holder for this preprint this version posted April 22, 2020. . possibility of model error. Equation (3) is called the state equation and describes the evolution of the unobserved state R t at any time. We assume that R t follows a martingale process that moves according to the gaussian innovation η t . Both t and η t are normally distributed with mean zero and variance σ 2 and σ 2 η . To use the Kalman filter, we need to estimate σ 2 and σ 2 η . To do so, we will break down the model in conditional densities from which we can sample iteratively (Gibbs sampling). 12 In the first step, conditional on σ 2 and σ 2 η , the Kalman filter will infer the state vector R t . In the second step, conditional on the sequence of R t computed in the previous step, we take samples of σ 2 and σ 2 η from their prior distributions. Once both steps are completed, we compute the Kalman smoother and proceed to the next iterations. A standard assumption is to choose Inverse-Gamma distributions as priors for σ 2 and σ 2 η . In particular, we assume as prior for σ 2 an Inverse-Gamma distribution with τ 0 and ω as the shape and scale parameters. In its turn, the prior for σ 2 η is also an Inverse-Gamma distribution with τ 0 and Ψ as shape and scale parameters. Regarding the filter, we also need to define initial values. In particular, we choose R 0 to be equal to the value estimated by Wang et al. (2020) . 9 For the variance of R t conditional on the information at t = 0, we choose the value of var î t st . Table 2 summarizes the values adopted for each case. 
Note: This table shows the priors adopted for each country. The first two columns describe the priors used to initialize the Kalman filter. The following three columns show the parameters that characterize the Inverse-Gamma distribution chosen as prior for the error terms in the measurement and observable equations described in section 2.
No funding was received for the purposes of study design, data collection, data analysis, data interpretation, or writing of the report. The corresponding author had full access to all the data in the study and had final responsibility for the decision to submit for publication.
. CC-BY-NC-ND 4.0 International license It is made available under a is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
The copyright holder for this preprint this version posted April 22, 2020. .
Our analysis covers China, Italy, Japan, and South Korea. We find that, except for Japan, the estimated peak of R t was reached around the dates when authorities started implementing epidemiological control policies (figure 1). 13, 14 However, we show that there is some heterogeneity in the response of R t to quarantine or social distancing. For instance, as shown in table 3, China  (fig 1a) and Korea (1b) reduced the effective reproduction number below one in less than twenty days after enacting the policies. At the same time, Italy (1c) declared a nationwide lockdown on March 9th, 2020, and still, the R t remains above, although closer to one. 15 Figure 1d shows Japan's estimated R t , which displayed a decreasing trend in the days following the outbreak but had a change in trend around March 18th, 2020. During the first 12 days after the outbreak, the median R t was 2·86 and then decreased to a minimum level of 1·52 on March 17th. However, around the date the Tokyo 2020 Olympic games were canceled, the decreasing trend reverted, and the estimated R t jump to its current level of 3·83. 16 This trend reversal contrasts sharply with the estimated evolution of R t for China, Korea, and Italy. Although it is challenging to identify causality, we think two hypotheses could explain this behavior. First, in contrast with the countries mentioned above, Japan's set of implemented measures to combat the pandemic does not include citywide lockdowns and strict social-distancing rules. Second, testing standards and capabilities could have changed over this time (we discussed a similar situation for China in the previous section), reveling important information that was missing before. It is worth noting that, as we will discuss in section 3.2, the Kalman filter does a good job of capturing trend changes. For instance, Chinese authorities announced on February 21st, 2020, a change in the accounting process of COVID-19 infections. This change implied a one time jump in new infections. 17 As can be seen in figure 1a , the filter captures the jump but then learns that most likely, it was noisy information and weights it off. This result constitutes a key advantage of the Kalman filter relative to other estimation methods. Instead of relying on the observer to 5 . CC-BY-NC-ND 4.0 International license It is made available under a is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
The copyright holder for this preprint this version posted April 22, 2020. 6 . CC-BY-NC-ND 4.0 International license It is made available under a is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
The copyright holder for this preprint this version posted April 22, 2020. . https://doi.org/10.1101/2020.04. 19.20071886 doi: medRxiv preprint decide whether the data anomaly is relevant or not. The Kalman filter is capable of using all the information available to decide how much attention should pay to the anomaly.
In this section, we test the accuracy of our method using data from 1000 simulated pandemics. We calibrated the simulations to match the levels of contagion reported so far in the actual data. For each simulated pandemic, we randomly chose the initial level of infected people and the basic reproduction number, so our simulation matches realistic outbreaks. Next, we add a stochastic declining trend to the daily reproduction number R t . This negative trend starts between 15 and 25 days of the initial infection (also randomly selected), and its purpose is to simulate the implementation of an epidemic-control policy during the outbreak. We calibrate this policy effort to reduce (on average) the daily reproduction number to be less than one, between 40 to 60 days after the policy implementation. Once at this point, we let the random process to increase the R t again. Note: This graph illustrates the performance of the Kalman filter for a single simulated pandemic. The estimations reflect each of the four underestimation scenarios described in the text. The time-series labelled as "actual" depicts the pandemic's "real" value of the daily reproduction number. The time-series denoted as "No Underestimation" corresponds to the estimated R t when the model uses unbiased data. The series labelled as "30% Underestimation" and "60% Underestimation" correspond to the estimated daily reproduction number when the model's input was biased following the mentioned rates. Finally, the time-series denoted as "Martingale Underestimation" corresponds to the case where new infections are underestimated following a martingale process. Figure 2 takes a snapshot at one of these simulated pandemics. The time-series denoted as "Actual" illustrates the "true" R t we used to generate the data. For this particular example, R t 7 . CC-BY-NC-ND 4.0 International license It is made available under a is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
The copyright holder for this preprint this version posted April 22, 2020. . decreases for about 80 days until it reaches one, after that it starts increasing again. The series labelled "no underestimation" shows that the Kalman filter tracks well these dynamics, and, as more information becomes available, its accuracy improves significantly. In real life, however, concerns about testing and measuring errors affect data reliability and make tracking the evolution of epidemic outbreaks notoriously difficult. For instance, during the current COVID-19 pandemic, there has been ample evidence of underestimation in the number of infections and deaths caused by the disease. [18] [19] [20] To evaluate how our model behaves in the presence of data misreporting or underestimation, we design two different tests. First, we fed into the model data where the number of infections was downward biased at a constant rate. * Second, we assumed there was a random rate of underestimation. † Since the model's outcomes are posterior distributions of R t at each time t, we define the median value of each distribution as our main estimate. Table 4a shows the mean forecast error for each of the scenarios mentioned above. In general, we observe that choosing informative priors allow us to reduce the forecast error at any time horizon (See tables 7a, 7b and 7c in the appendix for comparison). In particular, we find the filter's estimates are less accurate during the first days of the simulation. However, as new information becomes available, the filter learns and update its * We divided this exercise into two parts: First, we assumed that new infections were underestimated, on average, by 30 percent. Second, we repeated the exercise with an average underestimation rate of 60 percent. † In this case, each day, the data underestimate new infections at a randomly selected rate. The rate followed a martingale process bounded by the interval [10%, 90%].
. CC-BY-NC-ND 4.0 International license It is made available under a is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
The copyright holder for this preprint this version posted April 22, 2020. . priors accordingly. If new information contains noise (data underestimation), the filter correctly identifies it as model error and widens the confidence intervals to reflect this uncertainty (see table  4b and 5 ). Notes: Table 5 contains the proportion of times the "true" R t is contained within the 5th and the 95th percentiles of the posterior distribution. Each value corresponds to the day specified at the top the table.
Moreover, table 5 shows how well the posterior distributions compare against the "true" distributions. In general, we confirm that as more information becomes available, the model produces better estimates of R t . However, Martingale underestimation proves to be the worst-case scenario as the model has a tough time trying to disentangle information from noise. At this point, it is worth noting that these results are only quantitatively valid for the simulation processes described in this section. Readers should be careful and only extrapolate any of these statements to real data.
Using the Kalman filter and Bayesian techniques, we estimate the daily evolution of the effective reproductive number of COVID-19 for China, Italy, Japan, and South Korea. We find that China and South Korea have been able to reduce the median R t below one, while Italy and Japan show numbers above that threshold.
Our results indicate the effective reproductive number started at values 2·5 and 5·5, and in some cases, it increased temporarily beyond that level. The cases of China and Korea show that following the implementation of severe control measures (quarantine, extensive testing, and strict social distancing, among others), it took about two weeks for the daily effective reproductive number to fall below one. Our methodology has several limitations. First, the model is as only as good as the inputs that it receives. Therefore, as shown in section 3.2, low-quality data can induce biased estimates. By using all the information available in the data, Bayesian estimation techniques help us to overcome this issue but, since the "true" source of bias in the observable data is unknown, it is best to interpret our results as lower-bound estimates. Second, our method is sensitive to the priors we choose for the estimation. We found that using results from other papers available in the literature improves the quality of our estimates significantly. Third, our method is not able to provide forecasts, which are equally crucial as past estimates for policymakers looking to evaluate their interventions.
Our results show that there is substantial heterogeneity in the response of R t to epidemiological control policies. However, some generalities can be concluded in order to inform policymakers. In particular, if we use the Chinese and Korean experiences as guidelines for how long should the policies be in place after R t falls below one, it means countries like Italy (figure 1c) should be expecting lockdowns (or strict social distancing measures) to could last beyond two/three months. For instance, it was only until recently (April 8th, 2020), that China announced that it was ending the quarantine in Wuhan city, 76 days after it started. 21 In a context where there is increasing economic and political pressure to relax control measures, tools like the one presented in this paper, are critical to inform policymakers about the effectiveness of control measures, and the possible impacts of lifting earlier than recommended over the likelihood of effectively mitigating the outbreak.
The authors work for the Central Bank of Chile. The authors' salaries are not related to the elaboration of this study or its conclusions. All authors declare no competing interests.
. CC-BY-NC-ND 4.0 International license It is made available under a is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
The copyright holder for this preprint this version posted April 22, 2020. . https://doi.org/10.1101/2020.04. 19.20071886 doi: medRxiv preprint . CC-BY-NC-ND 4.0 International license It is made available under a is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
The copyright holder for this preprint this version posted April 22, 2020 
As before, we define the median value of each distribution as our main estimate. The first row of table 7a shows the fraction of times the posterior distribution contains the "true" value of R t at different time horizons. We see that, during the first 30-40 days, the filter is somewhat inaccurate. However, as more data comes in, the filter improves its accuracy considerably. The first rows of tables 7b and 7c confirm this idea. As time passes, the Kalman filter's mean forecasting error converges to zero with a small standard deviation.
When the filter is fed with actual data, we observe that the method's accuracy (captured by standard deviations of the forecast error) increases over time and eventually converges to actual values plus some noise. This noise is not surprising, since we have assumed that even actual values of the reproduction rate have some volatility. We contrasted this with the percentile intervals that are constructed by the filter itself, and found that the distributions of the basic reproduction number inferred by the filter performs poorer during the firsts 40 days, (intervals are too narrow) but then that it corrects itself after this period. As we point out in the paper, this problem is mitigated by using informative priors.
Any of the underestimation scenarios described does change the accuracy of our model. More precisely, it leads to an underestimation of the model error. Table 7a shows that the estimated posterior distributions are narrower than the actual "true" simulated distributions of R t . This fact seems to be particularly true for the first 60 days of the pandemics while the Kalman filter updates its priors. Notwithstanding, as more information becomes available, the filter's accuracy improves significantly, and, as shown by tables 7b and 7c, the mean forecasting error eventually converges to zero with a small standard deviation.
. CC-BY-NC-ND 4.0 International license It is made available under a is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity. (which was not certified by peer review)
The copyright holder for this preprint this version posted April 22, 2020 Notes: Table 7a contains the proportion of times the "true" R t is contained within the 5th and the 95th percentiles of the posterior distribution. Table 7b defines mean error as the mean deviation between the "true" values and the median estimated value of R t . Table 7c shows the the standard deviation of the mean error. Each value corresponds to the day specified at the top of each table.
14 . CC-BY-NC-ND 4.0 International license It is made available under a is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity. (which was not certified by peer review)
The copyright holder for this preprint this version posted April 22, 2020. . https://doi.org/10.1101/2020.04. 19.20071886 doi: medRxiv preprint 
