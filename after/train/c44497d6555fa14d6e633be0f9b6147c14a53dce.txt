12 Summary: Genome sequences constitute the primary evidence on the origin and spread 13 of the 2019-2020 Covid-19 pandemic. Rapid comparative analysis of coronavirus SARS-CoV-2 14 genomes is critical for disease control, outbreak forecasting, and developing clinical interven-15 tions. CoV Genome Tracker is a web portal dedicated to trace Covid-19 outbreaks in real time 16 using a haplotype network, an accurate and scalable representation of genomic changes in a 17 rapidly evolving population. We resolve the direction of mutations by using a bat-associated 18 genome as outgroup. At a broader evolutionary time scale, a companion browser provides gene-19 by-gene and codon-by-codon evolutionary rates to facilitate the search for molecular targets of 20 clinical interventions.
Genomic epidemiology comparatively analyzes pathogen genome sequences to uncover 33 the evolutionary origin, trace the global spread, and reveal molecular mechanisms of infectious 34 disease outbreaks including the latest coronavirus pandemic caused by the viral species SARS- At the micro-evolutionary time scale, a key distinction of CoV Genome Tracker from the 45 Nextstrain Covid-19 browser (https://nextstrain.org/ncov) (6) is our adoption of a haplotype net-46 work -instead of a phylogenetic tree -as the analytic framework as well as the visual guide (Fig  47   1) . A haplotype network offers several advantages over a phylogenic tree. First, at the time scale 48 of days and months, loss and fixation of alleles are rare and the ancestral and descendant gen-49 otypes are both present in the population. As such, tree-based phylogenies can be misleading 50 because tree-based phylogenetic algorithms compel all sampled genomes into leaf nodes re-51 gardless of ancestral or descendant genotypes, meanwhile introducing hypothetical ancestors 52 as internal nodes. Second, phylogenetic reconstruction typically assumes a mutation-driven pro-53 cess with complete lineage sorting. Violation of these assumptions results in misleading evolu-54 tionary relations, for example, when recombination is present or when genes remain polymorphic 55 (8,9). Third, a haplotype network requires less abstract comprehension of evolutionary pro-56 cesses than a phylogenetic tree does. For example, edges of a haplotype network depict genetic 57 changes from a parent to a descendant genome, while branches of a phylogenetic tree represent 58 genetic changes from a hypothetical ancestor to another hypothetical or sampled genome. 59
Fourth, a haplotype network is more scalable than a phylogenetic tree as a visual tool. This is 60 because the total number of nodes of a phylogenetic tree grows linearly with the number of 61 genomes, resulting in a crowded visual space. In contrast, additional genomes add to the size 62 . CC-BY-NC-ND 4.0 International license author/funder. It is made available under a The copyright holder for this preprint (which was not peer-reviewed) is the . https://doi.org/10.1101/2020.04.10.036343 doi: bioRxiv preprint but not the total number of nodes of a haplotype network if they share the same haplotype se-63 quence with previously sampled genomes. 64
A further innovation of the haplotype network used in the CoV Genome Tracker is the 65 inclusion of an outgroup genome to polarize all mutational changes. Conventional haplotype 66 networks show mutational differences but not mutational directions on edges (10-12). The di-67 rected haplotype network in CoV Genome Tracker is thus informative for tracing the origin, fol-68 lowing the spread, and forecasting the trend of Covid-19 outbreaks across the globe (Fig 1) . To 69 date, one published study and two preprint manuscripts use haplotype networks to represent the 70 genealogy of SARS-CoV-2 isolates (13-15). These networks are however based on a much 71 smaller number of genomes, non-interactive, and non-directional. 
The micro-evolutionary and macro-evolutionary browsers of the CoV Genome Tracker 83 are continuously updated according to the following workflows. 84
For the Covid-19 genome browser, we download genomic sequences and associated 85 metadata of SARS-CoV-2 isolates from GISAID (5), which are subsequently parsed with a PY-86 THON script ("parse-metadata.ipynb"; all scripts available in GitHub repository http://cov.ge-87 nometracker.org). We use a custom BASH script ("align-genome.sh") to align each genome to 88 an NCBI reference genome (isolate Wuhan-Hu-1, GenBank accession NC_045512) with Nu- The copyright holder for this preprint (which was not peer-reviewed) is the . https://doi.org/10.1101/2020.04.10.036343 doi: bioRxiv preprint script ("impute-hap.pl") is used to trim SNP sites at genome ends where missing bases are com-94 mon, discard haplotypes with more than 10% missing bases, (optionally) impute missing bases 95 of a haplotype with homologous bases from a closest haplotype (19), and identify unique haplo-96 types using the BioPerl package Bio::SimpleAlign (20). To root the haplotype network, we in-97 clude the genome of a closely related bat isolate (RaTG13, GenBank accession MN996532) (1) 98 as the outgroup (using however only nucleotides at the SNP sites present among human iso-99 lates). 100
We use two methods to infer a network genealogy of unique haplotypes. In one approach, 101
we infer a maximum parsimony tree using the DNAPARS program of the PHYLIP package (21). The copyright holder for this preprint (which was not peer-reviewed) is the . https://doi.org/10.1101/2020.04.10.036343 doi: bioRxiv preprint purifying selection while a higher or similar rate at the 1 st and 2 nd codon positions relative to the 127 rate at the 3 rd codon position suggests adaptive diversification (e.g., at the Spike protein-encod-128 ing locus) (2). The CoV comparative genomics browser is developed with the same software 129 infrastructure supporting BorreliaBase (http://borreliabase.org), a comparative genomics 130 browser of Lyme disease pathogens (16). 131
In summary, the CoV Genome Tracker facilitates up-to-date and interactive analysis of 133 viral genomic changes during current and future coronavirus outbreaks. The CoV Genome 134
Tracker uses a haplotype network, a more accurate and scalable model than a phylogenetic tree 135 to analyze and visualize genomic changes in the rapidly evolving SARS-CoV-2 population (6). 136
We improved upon conventional haplotype networks by resolving the direction of mutational 137 changes based on an outgroup genome (10,12). Future development will include implementing 138 probabilistic network algorithms such as maximum parsimony probability (10,11), developing 139 methods for testing network accuracy and stability, analyzing association between genomic 140 changes and network characteristics (e.g., association between the number of nonsynonymous 141 mutations and the in-and out-degrees of nodes), performance optimization, usability improve-142 ments, and incorporating a mechanism for community feedback. 143
Declaration 144
CoV Genome Tracker is publically available at http://cov.genometracker.org. All source 146 codes are released as Open Source and available at https://github.com/weigangq/cov-browser. 147
The repository contains BASH, Perl, Python, R, and JavaScript codes for data processing pipe-148 line, network reconstruction, and web development. 
We gratefully acknowledge the authors, originating and submitting laboratories of the se-159 quences from GISAID's EpiCoVâ„¢ Database on which this research is based. All submitters of 160 data may be contacted directly via www.gisaid.org. We thank Desiree Pante, Bing Wu, and Ra-161 mandeep Singh for participation in data entry. We thank Dr Yozen Hernandez for system admin-162 istration of computer networks. We thank Jonathan Sulkow for contributing to webpage design. 
