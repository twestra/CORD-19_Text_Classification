The coronavirus disease pandemic has increased the necessity of immediate clinical decisions and effective usage of healthcare resources. Currently, the most validated diagnosis test for COVID-19 (RT-PCR) is in shortage in most developing countries, which may increase infection rates and delay important preventive measures. The objective of this study was to predict the risk of positive COVID-19 diagnosis with machine learning, using as predictors only results from emergency care admission exams. We collected data from 235 adult patients from the Hospital Israelita Albert Einstein in São Paulo, Brazil, from 17 to 30 of March, 2020, of which 102 (43%) received a positive diagnosis of COVID-19 from RT-PCR tests. Five machine learning algorithms (neural networks, random forests, gradient boosting trees, logistic regression and support vector machines) were trained on a random sample of 70% of the patients, and performance was tested on new unseen data (30%). The best predictive performance was obtained by the support vector machines algorithm (AUC: 0.85; Sensitivity: 0.68; Specificity: 0.85; Brier Score: 0.16). The three most important variables for the predictive performance of the algorithm were the number of lymphocytes, leukocytes and eosinophils, respectively. In conclusion, we found that targeted decisions for receiving COVID-19 tests using only routinely-collected data is a promising new area with the use of machine learning algorithms.
During the last month, coronavirus disease 2019 (COVID-19) has spread rapidly from China to European countries, and is now experiencing exponential growth in the United States and Canada. 1 Recently, there has also been a sharp increase in cases in developing countries, but due to a limited number of COVID-19 tests available for these countries, the real extent of the spread is still unknown, which may lead to dire consequences in terms of adequate clinical care and the epidemiological knowledge needed to guide public containment measures. 2, 3 The most common symptoms of COVID-19, such as fever and cough, are similar to a range of other infectious diseases, making prompt diagnosis a challenge for health professionals. 4 Results from the transcription polymerase chain reaction test (RT-PCR), currently the most reliable diagnostic test, are frequently taking more than a week to become available according to reports in the Brazilian media, while in the meantime there is a need for immediate decisions about clinical care and preventive measures. On the other hand, the recent increase in the usage of new rapid diagnostic tests, which are prone to some accuracy issues, may increase the risk of inefficient allocations of health resources.
This study aims to improve decisions regarding COVID-19 test priorities in developing countries by predicting the risk of a positive diagnosis, using only routinely-collected data from emergency care admission exams. We analyzed the results of COVID-19 tests performed at Hospital Israelita Albert Einstein (HIAE) in São Paulo, Brazil, one of the main test providers in the country during the first weeks of local outbreak. This study was conducted under a task-force established to respond to the COVID-19 emergency within the PROADI-SUS program.
According to current guidelines from the Brazilian Ministry of Health, COVID-19 tests should only be applied to patients with severe acute respiratory syndrome. 5 Between 17 and 30 of March 2020, there were 256 results for COVID-19 transcription polymerase chain reaction (RT-PCR) tests performed in patients admitted to the emergency department of HIAE with a corresponding blood count test. A total of 235 adults had full results for total blood count and polymerase chain reaction (PCR) in the 24 hours around the RT-PCR test and were included in the analysis. From these, 102 (43%) patients tested positive for COVID-19.
A total of 15 variables were used for training the algorithms: age, gender, hemoglobin, platelets, red blood cells, mean corpuscular hemoglobin concentration (MCHC), mean corpuscular hemoglobin (MCH), red cell distribution width (RDW), mean corpuscular volume (MCV), leukocytes, lymphocytes, monocytes, basophils, eosinophils and c-reactive protein (CRP).
We tested the predictive performance for positive diagnosis of COVID-19 of five popular machine learning algorithms (neural networks, gradient boosted trees, random forests, logistic regression and support vector machines) with 10-fold cross validation for hyperparameter tuning . CC-BY-NC 4.0 International license It is made available under a is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
(which was not peer-reviewed) The copyright holder for this preprint .
with hyperopt (Bayesian optimization) search. All variables except gender were numerical and were therefore normalized to avoid oversized effects due to difference in scales. The sample was randomly divided using a 70-30 split, where 70% of the patients were used to train the machine learning algorithms, and the other 30% were used to test the performance of the models on new unseen data. All the results presented here are from the test set.
We measured predictive performance by calculating the area under the ROC curve (AUC), sensitivity, specificity, F1-score, Brier score, positive predictive value (PPV) and negative predictive value (NPV). All analyses were performed in Python using the scikit-learn library. The study was performed in accordance with the guidelines of Transparent Reporting of a Multivariable Prediction Model for Individual Prognosis or Diagnosis (TRIPOD) whenever applicable. 6 The study was approved by the Hospital Israelita Albert Einstein IRB (project number 4110-20) and by the National Commission for Ethics in Research (CONEP) of the National Health Council (CNS) from the Ministry of Health (CAAE: 30414720.0.0000.0071). Table 1 presents the descriptive results for the features included in the models, for all patients and separated according to COVID-19 diagnosis. The full sample was well balanced between males and females (51.1% and 48.9%, respectively), with a mean age of 49 years old. Within the COVID-19 positive group there were more men (65.7%), and lower mean values for leukocytes, lymphocytes, monocytes, basophil and eosinophils. Feature . CC-BY-NC 4.0 International license It is made available under a is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
The copyright holder for this preprint . https://doi.org/10.1101/2020.04.04.20052092 doi: medRxiv preprint
The two algorithms with best overall performance were random forests and support vector machines with an AUC of 0.85 for the test set. Figure 1 presents the AUC of the five algorithms, which shows that the performance was similar between the algorithms with some overlap across the different discriminative thresholds. The two algorithms with the best predictive performance (support vector machines and random forests) had the same discrimination results (sensitivity of 0.677 and specificity of 0.850), but the support vector machines algorithm had a slightly better calibration, with a Brier score of 0.160 (Table 2 ). Every one of the five algorithm had a positive predictive value of at least 0.74 and a negative predictive value of at least 0.77. is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
The copyright holder for this preprint .
Calibration details for the support vector machines algorithm are presented in Figure 2 , which shows that despite the small sample size, the algorithm is well calibrated throughout the probability distribution, i.e. among patients with a high predicted risk according to the algorithm, a high percentage of them are COVID-19 positive, and vice-versa. The five most important variables for the predictive performance of the algorithm according to the Mean Decrease Accuracy (MDA) were lymphocytes, leukocytes, eosinophils, basophils and hemoglobin, respectively. We also tested the performance of the algorithms using 10-fold cross validation repeated 10 times for each algorithm, instead of using the 70-30 split. This strategy is frequently used in machine learning in health studies especially in cases of relatively small samples such as ours, but it simulates less clearly the results in clinical applications. The predictive performance of the algorithms was better in comparison with the previous strategy, with an AUC of 0.87, Sensitivity of 0.755 and Specificity of 0.829 for the best-performing algorithm, which was again the support vector machines (Annex 1).
We found that by using only standard exams performed upon emergency care admission, machine learning algorithms were able to predict with good performance the risk of each patient having a positive result for COVID-19. As of April 5, 2020, there have been a total of 11,130 confirmed cases of COVID-19 in Brazil. Due to an overall shortage of tests, the current recommendation from Brazilian Ministry of Health is that tests should only be performed for critically-ill patients, contrary to the guidance of the World Health Organization which encourages large-scale tests of the population. 7 There are now also confirmed cases in most African countries and India, where the potential of rapid spread will require harsher cost-effective decisions on which patients to test for COVID-10.
The five machine learning algorithms had similar predictive performances, with AUCs higher than 0.84. The calibration results for the best performing algorithm (support vector machines) was consistent throughout the entire probability distribution. For example, among the patients with a predicted probability between 80 and 100% of having COVID-19, 82% of them actually had it; while for those with a predicted probability of 0 to 20%, 12% had it. This means future use of predicted probabilities is also promising, not only the binary decision of having COVID-19 or not, which improves the strength of potential clinical decisions derived from the results.
During the last few weeks, the first studies were published that apply machine learning to predict different COVID-19 outcomes. 8 So far only one study analyzed diagnosis of COVID-19 with routinely-collected data, in this case to predict cases using as controls patients with viral pneumonia by applying logistic regression. 9 Another study of 53 patients from two hospitals in Wenzhou, China, analyzed the accuracy of five machine learning algorithms to predict Acute Respiratory Distress Syndrome (ARDS) in patients with COVID-19. 10 Two other studies applied machine learning algorithms to predict mortality in patients with COVID-19, using patient data from Kaggle and China. 11, 12 We propose that machine learning algorithms can be used to allocate priorities in receiving the RT-PCR tests in the case of a shortage, and also to help with critical care decisions while the RT-PCR results are being processed (which have been frequently taking more than a week in most places of Brazil). A promising area for future research will also be to analyze the combined performance of the new rapid tests and the machine learning algorithms.
Further studies need to be performed in other locations to confirm these results. We analyzed a relatively small sample from the Hospital Israelita Albert Einstein, which was a firstresponder for COVID-19 cases in Brazil, but that has a large proportion of high-income patients and is frequently considered among the top hospitals in Latin America. Different stages of the disease may also influence the predictive performance of the models. We tried to decrease this effect by analyzing only patients in emergency care, but time interval from the first symptoms may also be a factor.
In conclusion, we found evidence to suggest that targeted decisions for receiving COVID-19 tests in areas with a shortage of supply is possible with the use of machine learning algorithms. For future clinical applications, locally training the algorithms in each specific healthcare service will be crucial to improve predictive performance. Annex 1 -Performance metrics for each machine learning algorithm for the 10-fold crossvalidation. . CC-BY-NC 4.0 International license It is made available under a is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
(which was not peer-reviewed) The copyright holder for this preprint . https://doi.org/10.1101/2020.04.04.20052092 doi: medRxiv preprint
