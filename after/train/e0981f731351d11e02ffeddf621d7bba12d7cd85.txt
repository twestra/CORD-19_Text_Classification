Coronavirus disease has spread around the world causing tremendous stress to the US health care system. Knowing the trend of the COVID-19 pandemic is critical for the federal and local governments and health care system to prepare plans. Our aim was to develop an approach and create a SAS macro to estimate the growth rate and doubling time in days if growth rate is positive or half time in days if growth rate is negative. We fit a series of growth curves using a rolling approach. This approach was applied to the hospitalization data of Colorado State during March 13 th and April 13 th . The growth rate was 0.18 (95% CI=(0.11, 0.24)) and the doubling time was 5 days (95% CI= (4, 7)) for the period of March 13 th -March 19 th ; the growth rate reached to the minimum -0.19 (95% CI= (-0.29, -0.10)) and the half time was 4 days (95% CI= (2, 6)) for the period of April 2 nd -April 8 th . This approach can be used for regional short-term prediction and monitoring the regional trend of the COVID-19 pandemic.
In December 2019, an outbreak of coronavirus disease (COVID-19) caused by the novel coronavirus (SARS-CoV-2) began in Wuhan, China and has now spread across the world [1, 2] . In the United States, the cumulative number of identified COVID-19 cases was 186,101 as of March 31st, 2020; among the identified cases, 3603 died [3] . To slow the spread of COVID-19, federal and local governments have issued mitigation measures such as case isolation, quarantine, school closures and closing non-essential businesses. The COVID-19 pandemic imposes tremendous challenges to the US health care system, particularly given concerns that the need for hospital beds and ICU beds could exceed capacity [4] [5] [6] . Predicting the future numbers of COVID-19 cases and healthcare utilization is critical for governments and health care systems preparation plans [4, 6, 7] . Two useful and critical quantities for prediction are the growth rate [8] and the doubling time of number of events [9] . The growth rate is the percent change of daily events (e.g, COVID-19 cases, number of patients hospitalized or number of deaths). The doubling time is the length of time required to double the number of daily events.
Our goal was to develop an approach and create a SAS macro using observed data to estimate the growth rate and doubling time in days for short-term prediction.
In the United States, there are several barriers for testing people for COVID-19 such as shortages of swabs and testing kits and restrictions on who should get tested. Therefore, the number of COVID-19 cases is often under-identified and under-reported. However, the number of hospitalized COVID-19 patients (hospitalizations) and number of deaths due to COVID-19 are more reliable than the reported number of COVID-19 cases [10] . In this paper, we used the number of daily hospitalized COVID-19 patients to calculate the growth rate and doubling time in days.
We assumed a growth curve of daily hospitalizations over a period of ݊ days from day ‫ݐ‬ (start day) to day ‫ݐ(‬ ݊ െ 1 
We fit two models: a) using equation (1) where ‫ݎ‬ is the estimated growth rate from the last period. As the growth rate changes over time, the prediction is only appropriate for short-term prediction (e.g., within 7 days) and updated growth rates should be used.
We estimated a series of growth rates using RGCA with a length of 7 days. The estimated growth rates and 95% CIs were plotted over time using the mid-day of a 7 day period ( Figure 1 ). The growth rate peaked with a value of 56.2% at the mid-day of March 18 th for the period March 15 th and March 21 st . Between March 18 th and April 1 st , although the growth rate continuously decreased, the daily number of hospitalizations increased because of positive growth rates. We started to observe negative growth rates after April 1 st , except for a positive growth rate on April 9 th . The growth rate reached its minimum at the mid-day of April 5 th (period April 2 nd -April 8 th ) with a value of -19.2%. The growth rate then increased after April 5 th . Note that a negative growth rate represents a reduction in number of hospitalizations.
The doubling time (growth rate>0) and half time (growth rate<0) in days over time are displayed in Figure 2 . Before April 1 st , the y-axis represents the doubling time in days because of positive growth rates. After April 1 st , except for a positive growth rate on April 9 th , the y-axis represents a half-time because of negative growth rates. On April 1 st , the reduction rate was very small (0.5%) which resulted in a high half-time, 128 days with very wide 95% CIs (not shown in the figure). On April 8 th , there was a small reduction rate (1.2%) resulting in 55 days of half time.
Using the estimated growth rate from the last period April 7 th -April 13 th ,
, the predicted numbers of daily hospitalizations for April 14 th and 15 th were 35 and 34, respectively. SAS programs are available for conducting these analyses (Appendix A and Appendix B).
These models can be similarly applied to death data if they are available and not sparse. When COVID-19 testing is widely available to the public and the number of COVID-19 testing is less selective, these models can also be used to directly estimate the growth rate and the doubling time for COVID-19 cases. Due to a lag in reporting hospitalization, it is recommended to exclude the recent 1-2 days' hospitalization data in fitting the growth curves. This paper illustrates that hospitalization data can be used to estimate the growth rate and doubling (or half) time to aid predicting future hospitalizations, deaths and COVID-19 cases. Because a series of growth curves were fit, the RGCA approach can also be used for real-time monitoring of the epidemic trend as shown in Figure 1 .
Colorado state issued three social distancing guidelines: a voluntary social distancing on March 17 th , closing educational facilities on March 23 rd , and closing non-essential services on March 26 th (Figure 1 ). It takes some time (e.g., 2 weeks) for these mitigation measures to have impact. Although the effectiveness of these mitigation measures has not been investigated formally, it is believed that they helped to slow the spread of COVID-19 and reduced number of hospitalizations and death in Colorado and across the United States. . CC-BY-NC-ND 4.0 International license It is made available under a author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
is the (which was not peer-reviewed) The copyright holder for this preprint . . CC-BY-NC-ND 4.0 International license It is made available under a author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
is the (which was not peer-reviewed) The copyright holder for this preprint . https://doi.org/10.1101/2020.04.08.20057943 doi: medRxiv preprint APPENDIX A /************************************************************* * Title: . CC-BY-NC-ND 4.0 International license It is made available under a author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
is the (which was not peer-reviewed) The copyright holder for this preprint . https://doi.org/10.1101/2020.04.08.20057943 doi: medRxiv preprint title 'Growth rate and doubling time for each interval'; proc print data = r_doubling_time; var start_day end_day mid_day r r_lowercl r_uppercl doubling_time doubling_time_lowercl doubling_time_uppercl;
format start_day end_day mid_day mmddyy10.; run; ods listing gpath="&codeanddat"; title1 'Estimated growth rate (r) and 95% Confidence Intervals'; title2 'Using CO Hospitalization data between March 13th-April 13th'; proc sgplot data=r_doubling_time; band x = mid_day lower = r_LowerCL upper = r_UpperCL/ fillattrs = (color = graydd) name='band95' legendlabel='95% CI'; series x = mid_day y = r/ lineattrs = (color = red thickness = 3px) name = 'line' legendlabel = 'growth rate'; yaxis labelpos = center label = "growth rate per day" thresholdmax=.8; xaxis labelpos = center label = "Mid day of a seven day period" thresholdmax=.8; keylegend 'line' 'band95' / position = topright location = inside across = 1 opaque noborder valueattrs=(color = gray33); run;
title 'Estimated doubling time (or half time when r<0) in days (D) and 95% CIs'; title2 'Using CO Hospitalization data between March 13th-April 13th'; proc sgplot data=r_doubling_time; band x = mid_day lower = doubling_time_LowerCL upper = doubling_time_UpperCL/ fillattrs = (color = graydd) name = 'band95' legendlabel = '95% Confidence Interval'; series x = mid_day y = doubling_time/ lineattrs = (color = blue thickness = 3px) name = 'line' legendlabel = 'doubling time'; yaxis labelpos = center label = "doubling time in days" thresholdmax = .8 min=0 max=30; xaxis labelpos = center label = "Mid day of a seven day period" thresholdmax = .8;
CC-BY-NC-ND 4.0 International license It is made available under a author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
is the (which was not peer-reviewed) The copyright holder for this preprint . https://doi.org/10.1101/2020.04.08.20057943 doi: medRxiv preprint position = topleft location = inside across = 1 opaque noborder valueattrs = (color = gray33); run;
/************************************************************* * Title: * Programmer: Stanley Xu and Christina Clarke Institute for Health Research * Kaiser Permanente Colorado * * Date Created: 4/3/2020 * Description: This macro is designed to calculate a predicted * growth and doubling time of a disease given observed * data. In particular, these models were based on observed * deaths since the true denominator is often unknown given * testing may not be done on all symptomatic or asymtomatic * individuals. Further, hospitalizations could be used if they * are known. * * Input: indat = input dataset with the number of deaths and date of those deaths during a date range * that is to be modeled. * dateofevent = variable name of te date the deaths occurred from the indat dataset * numevents = variable name that has the number of deaths that occurred on each date of death * from the indat dataset * int_length -number of days in each interval -our * example examined 7 day intervals to create piece-wise growth intervals * * * Output: * * References: * * Changes to the code log : cclarke CH001 remove the state variable option **************************************************************/ %macro Calc_GrowthRates(indat, dateofevent, numevents, int_length); *First, we need to get the start and end dates from the input dataset.; proc sql noprint; select distinct min(&dateofevent) ,max(&dateofevent) into :fup_start ,:fup_end from &indat ; quit; /*For QA -Prints the first and last date found in the input data file which will appear in the log*/ data _null_; start = &fup_start; endloop = &fup_end-&int_length+1;
format start endloop date9.;
put "Looping through the starting date and the last date -&int_length +1 days:"; put start = endloop =; run; %do start_day = &fup_start %to (&fup_end-&int_length+1); /*Hold onto the current start day to append to some of the final datasets so they do not get overwritten*/ %let stdyfmt = %sysfunc(putn(&start_day,date9.)); /*Using the input dataset, calculate the last day that will be considered in these calculations for each interval. /*This model will estimate r, the growth rate. Create one dataset for each iteration of the start day.*/ proc nlin data=CGR_dat02 list noitprint; parms r 0.75; model &numevents = start_new_event*((1+r)**(&dateofevent -&start_day)); output out = preddeath_start_&stdyfmt . CC-BY-NC-ND 4.0 International license It is made available under a author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
is the (which was not peer-reviewed) The copyright holder for this preprint /*Add the current doubling time and growth rate to an overall dataset to print charts*/ proc append base = r_doubling_time new = r_doubling_time0 force; run; quit; %end; /*Print the resulting data*/ %do start_day = &fup_start %to (&fup_end-&int_length+1); %let stdyfmt = %sysfunc(putn(&start_day,date9.)); TITLE "Observed and predicted events and 95% CI for the interval beginning on &stdyfmt"; proc print data=preddeath_start_&stdyfmt noobs; var &dateofevent &numevents pred lower95 upper95;
format &dateofevent mmddyy10.; run; %end;
*Now look at the short-term future predictions based on the last date of deaths from the incoming dataset. The . CC-BY-NC-ND 4.0 International license It is made available under a author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
is the (which was not peer-reviewed) The copyright holder for this preprint . https://doi.org/10.1101/2020.04.08.20057943 doi: medRxiv preprint corresponding number of deaths will also be used.; /*First, get the number of deaths/events on the last day (k) of the last period for estimating the growth rate*/ proc sql noprint; select distinct &numevents into :y_k from &indat where &dateofevent = &fup_end ; quit; /*Next, get r_k from the doubling time, which is the estimated growth rate from the last period*/ proc sql noprint; select distinct r ,r_lowerCL ,r_upperCL into :r_k, :r_k_lower, :r_k_upper from r_doubling_time where end_day = &fup_end ; quit; %put &fup_end &y_k &r_k &r_k_lower &r_k_upper; data prediction; k=&fup_end; do i=1 to &int_length; m = k + i; y_m = round(&y_k*((1+&r_k))**(m-k)); y_m_lowerCL = round(&y_k*((1+&r_k_lower))**(m-k)); y_m_upperCL = round(&y_k*((1+&r_k_upper))**(m-k)); output; end; format m date9.; keep m y_m y_m_lowerCL y_m_upperCL; run;
title "Predicted number of deaths for the next &int_length days"; proc print data=prediction noobs; run; %mend Calc_GrowthRates;
. CC-BY-NC-ND 4.0 International license It is made available under a author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
is the (which was not peer-reviewed) The copyright holder for this preprint . https://doi.org/10.1101/2020.04.08.20057943 doi: medRxiv preprint
