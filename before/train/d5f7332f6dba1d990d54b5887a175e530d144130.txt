The effective reproduction number, Rt, is an important prognostic for 2 infectious disease epidemics. Significant changes in Rt can forewarn about 3 new transmissions or predict the efficacy of interventions. The renewal 4 model infers Rt from incidence data and has been applied to Ebola virus 5 disease and pandemic influenza outbreaks, among others. This model 6 estimates Rt using a sliding window of length k. While this facilitates 7 real-time detection of statistically significant Rt fluctuations, inference is 8 highly k -sensitive. Models with too large or small k might ignore meaning-9 ful changes or over-interpret noise-induced ones. No principled k -selection 10 scheme exists. We develop a practical yet rigorous scheme using the ac-11 cumulated prediction error (APE) metric from information theory. We 12 derive exact incidence prediction distributions and integrate these within 13 an APE framework to identify the k best supported by available data. We 14 find that this k optimises short-term prediction accuracy and expose how 15 common, heuristic k -choices, which seem sensible, could be misleading. 16 18 fectious disease epidemic is known as an incidence curve or epi-curve [1]. At 19 the population level, these curves offer prospective insight into the spread of a 20 disease by informing on the effective reproduction number, which defines the 21 average number of secondary infections induced by a primary one [2]. This 22
reproduction number, denoted R t at time t, is an important prognostic of the 23 behaviour of an epidemic. If R t > 1, for example, we can expect and hence 24 prepare for an exponentially increasing incidence, whereas if R t < 1, we can be 25 1 . CC-BY-NC-ND 4.0 International license is made available under a The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. It . https://doi.org/10.1101/835181 doi: bioRxiv preprint reasonably confident that the epidemic has been arrested [2]. Reliably estimat-26 ing meaningful changes in R t is an important problem in epidemiology, since 27 it can forewarn about the growth rate of an outbreak and signify the level of 28 control effort that must be initiated or sustained [3] [4]. 29 The renewal model [5] is a popular approach for inferring salient fluctuations 30 in R t and has been used to predict Ebola virus disease case counts and assess the 31 transmission potential of pandemic influenza and Zika virus, among others [6] [7] 32 [3]. The renewal model may be applied retrospectively to understand the past 33 behaviour of an epidemic or prospectively to gain real-time insight into ongoing 34 outbreak dynamics [8] [5]. We only consider the latter here. Model selection 35 metrics for the former application were investigated in [9]. The prospective ap-36 proach approximates R t with a piecewise-constant function i.e. R t is considered 37 constant or stable over some sliding window of k time units (e.g. days or weeks) 38 into the past, beyond which a discontinuous change is assumed [8].
39 This formulation models the non-stationary nature of epidemics, capturing 40 the idea that different dynamics are expected during distinct phases (e.g. onset, 41 growth, control) of the epidemic lifetime. The window length, k, is effectively a 42 hypothesis about the stability of R t underpinning the observed epi-curve and is 43 critical to reliably characterising the epidemic because it controls the time-scale 44 over which R t fluctuations are deemed significant. Too large or small a k-value 45 can respectively lead to over-smoothing (which ignores important changes) or 46 to random noise being misinterpreted as meaningful. Inferring under the wrong 47 k can appreciably affect our understanding of an epidemic, as observed in [5], 48 where case reproduction numbers (a common k-grouping of R t ) were found to 49 over-smooth significant changes in HIV transmission, for example.
50 Surprisingly, no principled method for optimally selecting k exists. Current 51 best practice either relies on heuristic choices (including visual trial and error) [6] 52 or provides implicit, minimum thresholds for k [8]. Here we adapt metrics from 53 information theory to develop a simple yet rigorous framework for optimising k.
54
Specifically, we analytically derive the posterior predictive incidence distribution 55 of the renewal model and then minimise its accumulated prediction error (APE) 56 [10] over the space of possible k, to obtain k * . The APE is a formal, data-57 driven, model selection strategy that identifies the k * most justified by the 58 available incidence data by optimising for short-term predictive accuracy [11] .
The renewal model with this k * best explains the observed epi-curve.
The APE metric is valid for all sample sizes, is easily computed for models of 61 arbitrary dimension and is strongly linked to Bayesian model selection (BMS), 62 cross validation and minimum description length (MDL) [12] [13]. Unlike many 63 standard model selection approaches, the APE accounts for parametric com-64 plexity, which describes how functional dependencies among parameters matter 65 [14]. Ignoring parametric complexity is known to promote suboptimal renewal 66 model selection performance [9]. The APE metric deems the model that best 67
predicts unseen data from the same underlying process, and not the one that 68 best fits existing data, as optimal and of justified complexity [15].
Our APE-based approach should therefore pinpoint and characterise only 70 those reproduction number fluctuations that are key to achieving reliable short-
The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. It . https://doi.org/10.1101/835181 doi: bioRxiv preprint term incidence predictions. The performance, speed and computational ease of 72 our approach makes it suitable for real-time forecasting and model selection.
It could serve as a stand-alone computational tool or be integrated within ex-74 isting real-time frameworks, such as in [4], to provide emerging insights into 75 infectious transmission dynamics, or to assess the prospective efficacy of im-76 plemented interventions (e.g. vaccination or quarantine). Public health policy 77 decisions or preparedness plans based on improperly specified k-windows could 78 be misinformed or overconfident. Our approach will hopefully limit these risks. 79 Results 80 Problem Definition 81 Let the incidence or number of infected cases in an epidemic at present time t, 82 be I t . The incidence curve is a historical record of these case counts from the 83 start of the outbreak [1], and is summarised as I t 1 = {I s : 1 ≤ s ≤ t}, with s as a 84 time-indexing variable. For convenience, we assume that incidence is available 85 on a daily scale so that I t 1 is a vector of t daily counts (though in general weeks 86 or months could be used instead). The associated effective reproduction number 87 and total infectiousness of the epidemic are denoted R t and Λ t , respectively. 88 Here R t is the number of secondary cases that are induced, on average, by 89 a single primary case at t [2], while Λ t measures the cumulative impact of past 90 cases, from the epidemic origin at s = 1, on the present. The generation time 91 distribution of the epidemic, which describes the elapsed time between a primary 92 and secondary case, controls Λ t (see Methods). In the problems we consider, I t 1 93 and Λ t 1 form our data, the generation time distribution is assumed known, and 94 R t 1 or some grouping of this vector are the parameters to be inferred. 95 The renewal model [5] [6] derives from the classic renewal epidemic trans-96 mission equation [26], and defines the Poisson distributed (Poiss) relationship 97 I t ∼ Poiss (R t Λ t ). This means that P(x) = 1 /x! e −RtΛt (R t Λ t ) x , with x in-98 dexing possible I t values. This formulation assumes maximum epidemic non-99 stationarity (i.e. that transmission statistics change every time unit) and hence 100 only uses the most recent data (I t , Λ t ) to infer the current R t . While this max-101 imises the fitting flexibility of the renewal model, it often results in noisy and 102 unreliable estimates that possess many spurious reproduction number changes 103 [6]. Consequently, grouping is employed. This hypothesises that the repro-104 duction number is constant over a k-day window into the past and leads to a 105 piecewise-constant function that separates salient fluctuations (change-points) 106 from negligible ones (the constant segments) [8] [9]. 107 We use R τ (t) to indicate that the present reproduction number to be inferred 108 is stationary (constant) over the last k points of the incidence curve i.e. the time 109 window τ (t) := {t, t − 1, . . . , t − k + 1}. The data used to estimate R τ (t) is 110 then (I t t−k+1 , Λ t t−k+1 ). This construction allows us to filter noise and increase 111 estimate reliability but elevates bias. In the Methods we show precisely how 112 grouping achieves this bias-variance trade-off. Choosing k therefore amounts to 113 3 . CC-BY-NC-ND 4.0 International license is made available under a
The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. It . https://doi.org/10.1101/835181 doi: bioRxiv preprint selecting a belief about the scale over which the epidemic statistics are meaning-114 fully varying and can significantly influence our understanding of the dynamics 115 of the outbreak. Thus, it is necessary to find a principled method for balancing 116 k. Ultimately, we want to find a k, denoted k * , that (i) is best supported by 117 the epi-curve and (ii) maximises our confidence in making real-time, short-term 118 predictions that can inform prospective epidemic responses. 119 This is no trivial task as k * would be sensitive to both the specifically ob-120 served stochastic incidence of an epidemic and to how past infections propagate 121 forward in time. We solve (i)-(ii) by applying the accumulated prediction error 122 (APE) metric from information theory [10], which values models on their capac-123 ity to predict unseen data from the generating process instead of their ability to 124 fit existing data [11]. The properties and mathematical definition of the APE 125 355
cept I s+1 are included [21]. Comparing this to Eq. (9) (see Methods) we see 356 that APE is a modified CV that is explicitly specialised for non-stationary, 357 accumulating time-series.
(c) Lack of a 'true model'. It is highly unlikely that the underlying R t is truly 359 described by one of the piecewise-constant functions assumed within renewal 360 models. Unlike many model selection criteria, the APE does not require a true 361 model to exist within the set being evaluated [14]. It is only interested in finding 362 the model that best predicts the data and so emphasises accurate forecasting 363 and data-justified complexity. However, should a true model exist, the APE is 364 statistically consistent i.e. as data accumulate it will select the data-generating 365 model with probability 1 [14]. 366 We tested our metric on both simulated and empirical datasets. We started 367 by examining various distinct, time-varying reproduction number profiles in 368 Fig. 2 , for which no true model existed. By comparing the APE-optimised 369 k * against long and short window sizes, we found that not only does APE 370 meaningfully balance R t estimates to achieve good prediction capacity, but also 371 that getting k wrong could promote strikingly different conclusions from the 372 same dataset. This behaviour held consistent for outbreaks with both small 373 and large numbers of infecteds. 374 We then investigated several step-changing reproduction number examples 375 in Fig. 4 to better expose the underlying mechanics of our approach, and to 376 showcase its performance on epidemics with strong non-stationary transmission.
These examples featured rapid changes, also known as events in information 378 theory, caused by effective and ineffective countermeasures [4]. In all cases, our 379 metric responded rapidly whilst maintaining reliable incidence predictions in 380 real-time. Such rapid, event-triggered responses (as in Fig. 5) are known to 381 be time-efficient [22]. A key objective of short-term forecasting is the speedy 382 diagnosis of intervention efficacy. Fig. 4 confirmed the practical value of our 383 method towards this objective. 384 While our metric is promising, we caution that much work remains to be 385 done. Standard Poisson renewal models, such as those we have considered here, 386 make several limiting assumptions including that (i) all cases are detected (i.e. 387 there is no significant sampling bias), (ii) the serial interval and generation time 388 distribution coincide and do not change over the epidemic lifetime and (iii) that 389 heterogeneities in transmission within the infected population have negligible 390 effect [8]. Our analysis of H1N1 influenza (1918) and SARS (2003) flagged 391 some of these concerns. Comparing the k * to previously recommended weekly 392 windows led to some interesting revelations.
The APE approach selected a notably shorter window (k * = 2 days) for both 394 datasets. While this produced noisy R s estimates that seemed less reliable than 395 those obtained with weekly windows, the predicted incidence values were central 396 to understanding this discrepancy. The weekly windows were considerably worse 397 at forecasting the observed epi-curve, often systematically biased around the 398 peak of the epidemic and sometimes predicting multi-modal curves that were 399 not reflected by the existing data. From a model selection perspective, the 400 shorter windows are therefore justified. 401 However, the noisy R t estimates are still undesirable. Both datasets are 402 known to potentially contain super-spreading heterogeneities and other biases 403 that may lead to outliers [17] [8]. Moving-average filters were applied in [17] 404 15 . CC-BY-NC-ND 4.0 International license is made available under a
The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. It . https://doi.org/10.1101/835181 doi: bioRxiv preprint to remove these artefacts from the H1N1 data. We used the same technique 405 to regularise both datasets and then re-applied the APE. Results remained 406 consistent, providing evidence for the use of more flexible negative binomial 407 renewal models, which can better handle these biases. In an upcoming study 408 we will adapt the APE for these more general renewal methods. 409 Real-time, model-based epidemic forecasts are quickly becoming an inte-410 gral prognostic for resource allocation and strategic intervention planning [23]. 411 As global infectious disease threats elevate, model-supported predictions, which 412 can inform decision making, have become imperative. However, much is still un-413 known about the fundamentals of epidemic prediction and this uncertainty has 414 inspired some reluctance in public health applications [23]. As a result, recent 415 studies have called for careful evaluation of the predictive capacity of models, 416 and demonstrated the importance of having standard metrics to compare models 417 and qualify their uncertainties [24] [25]. 418 Here we have presented one such metric. Short-term forecasts aid immedi-419 ate decision making and are more actionable than long-term ones (reliability 420 decreases sharply with prediction horizon) [24] [23]. While we focussed on re-421 newal models, the general APE metric of Eq. (9) can select among diverse types 422 of models, facilitating comparative evaluation of their short-term predictive ca-423 pacity and reliability. Its direct use of posterior predictive distributions within 424 an honest, causal framework allows proper and problem-specific inclusion of 425 uncertainty [11]. Common metrics such as the mean absolute error lack this 426 adaptation [24]. Given its information-theoretic links and demonstrated perfor-427 mance we hope that our APE-based method can serve as a rigorous benchmark 428 [9] K. Parag and C. Donnelly, "Adaptive estimation for epidemic renewal and 561 phylogenetic skyline models," BioRxiv, 2019.
The time-series of infected cases (infecteds) observed over the course of an in-are provided in the Methods. The APE uses the window of data preceding time 126 s, (I s s−k+1 , Λ s s−k+1 ), to predict the incidence at s + 1 and assigns a log-score to 127 this prediction. This procedure is repeated over s ≤ t and for possible k-values. 128 The k achieving the minimum cumulated log-score is deemed optimal. Fig. 1 129 illustrates the APE for selecting between two windows k 1 and k 2 . Figure 1 : Window length selection using APE. An observed incidence curve (blue dots) is sequentially and causally predicted over time s ≤ t, using effective reproduction number estimates based on two possible windows lengths of k 1 and k 2 (green shaded). The true reproduction number (R s ) is drawn in dashed black (inset). Its estimates for each window length areR τ1(s) (dark grey) andR τ2(s) (light grey). Large windows (k 1 ) smooth over fluctuations. Small ones (k 2 ) recover these changes but are noisy. The APE assesses k 1 and k 2 via the log-loss of their sequential predictions (red error bars shown for predictions at t 1 and t 2 under k 1 and k 2 respectively). The k-window with the smaller APE is better supported by this incidence curve. The algorithm parameters are defined in Results.
. CC-BY-NC-ND 4.0 International license is made available under a The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. It . https://doi.org/10.1101/835181 doi: bioRxiv preprint
To successfully adapt APE, we require the posterior predictive incidence dis-132 tribution of the renewal model, which at time s is P(x | I s s−k+1 ) (see Eq. (9)), 133 with x indexing the space of possible one-step-ahead predictions at s + 1, and
. We assume a gamma conjugate prior distribution on R τ (s) as in 135 [8] . For some hyperparameters a and c this is R τ (s) ∼ Gam (a, 1 /c), with Gam 136 as a standard shape-scale parametrised gamma distribution. The posterior dis-137 tribution of R τ (s) is P(R τ (s) | I s s−k+1 ) and is described in Eq. (1) [8] . 138 R τ (s) | I t s−k+1 ∼ Gam a + i τ (s) ,
139 140
For convenience we define α τ (s) := a + i τ (s) , β τ (s) := 1 /c+λ τ (s) with i τ (s) and 141 λ τ (s) are the sum of incidence (I s ) and total infectiousness (Λ s ) over the window 142 τ (s) (see Methods). If a variable y ∼ Gam(α, β) then P(y) = y α−1 e − y /β /β α Γ(α) 143 and E[y] = αβ. The posterior mean estimate is thereforeR τ (t) = α τ (t) β τ (t) .
Applying Bayes formula and marginalising yields the posterior predictive dis-145 tribution of the number of infecteds at s + 1 as in Eq.
(2).
In Eq.
(2) we used the conditional independence of future incidence data from 149 the past epi-curve, given the reproduction number to reduce P x | I s s−k+1 , R τ (s) 150 to P x | R τ (s) , which expresses the renewal model relation x ∼ Poiss(R τ (s) Λ s+1 ).
As Λ s+1 only depends on I s s−k+1 (see Methods) there are no unknowns. Solving 152 using this and Eq. (1) gives
Since θ z−1 e −yθ dθ ≡ Γ(z) /y z the integral in φ 1 simplifies to Γ(x+α τ (s) ) (Λs+1+ 1 /β τ (s) ) x+α τ (s) .
Some algebra then reveals the negative binomial (NB) distribution of Eq. (4). 
λ τ (s) +Λs+1 . These relations explicate how the current 165 estimate of R τ (s) influences our ability to predict upcoming incidence points. 166 Setting s = t in all the above expressions will give the prediction statistics for 167 the next (unobserved) time-point beyond the present. 168 Importantly, Eq. (4) controls the APE metric through the shape of its dis-169 tribution. We explicitly compute this to derive Eq. (5), with I s+1 as the (true) 170 observed incidence at time s + 1, which is evaluated within the context of the 171 predictive space of x, and B s+1 := log Is+1+α τ (s) −1 Is+1 as a binomial term.
Eq. (5) is easy to evaluate using the in-built NB routines of many software.
When computing directly, the most difficult term is B s+1 when I s+1 and α τ (s) 176 are large. In these cases Stirling approximations may be applied. The renewal 177 model APE metric offers a simple means of finding k * := arg min k APE k , the 178 window length that optimises one-step-ahead predictive performance.
Optimal Window Selection 180 We apply our APE metric to select k * for various epidemic examples, which 181 examine reproduction number profiles for large outbreaks (Fig. 2a-Fig. 2c ), 182 small ones (which are more difficult to estimate: Fig. 2d-Fig. 2e) , and a random 183 one (Fig. 2f) . We simulated epidemics for t = 200 days using a generation time 184 distribution analogous to that used for Ebola virus disease predictions in [16] . 185 We investigated a window search space of 2 ≤ k ≤ t /2 and computed the APE at 186 each k, over the epidemic duration (1 ≤ s ≤ t). Reproduction number estimates, 187R τ (s) , and incidence predictions, x | I s s−k+1 , are presented on the left and right 188 panels in Fig. 2 . Predictions over the first s < k times use all s data points. 189 We find that the APE metric balancesR τ (s) estimate accuracy against one- When k is unjustifiably large not only do we observe systematic prediction 201 and estimation errors, but alarmingly, we tend to be overconfident in them.
When k is too small, we infer rapidly and randomly fluctuatingR τ (s) values, 203 which sometimes can deceptively underlie reasonably looking incidence predic-204 tions. Consequently, optimal k-selection is integral for trustworthy inference 205 6 . CC-BY-NC-ND 4.0 International license is made available under a The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. It . https://doi.org/10.1101/835181 doi: bioRxiv preprint The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. It . https://doi.org/10.1101/835181 doi: bioRxiv preprint Figure 3 : APE prediction accuracy. We compare the APE metric (solid blue, left y axis) to the percentage of true incidence values, I s+1 that fall outside the 95% prediction intervals of x | I s s−k+1 (dotted red, right y axis) over the window search space k. The dashed line is k * and panels correspond to those of Fig. 2. and prediction. Observe that small k, which implies a more complex renewal 206 model (i.e. there are more parameters to be inferred), does not generally result 207 in better causally predictive one-step-ahead incidence predictions. Had we in-208 stead naively picked the k that best fits the existing epi-curve, then the smallest 209 k would always be favoured (overfitting) [9]. 210 We emphasize and validate the predictive performance of APE in Fig. 3 . The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. It . https://doi.org/10.1101/835181 doi: bioRxiv preprint tify our results over 10 3 simulated epi-curves with t = 150 days. We focus on 228 step-changes in R s and examine how the successively optimal window length, 229 k * (s), computed with data up to time s, responds. If k * (s) is sensitive to these 230 changes then it is likely a dependable means of diagnosing control efficacy. Note 231 that until now, the optimal window length was k * = k * (t). 232 We consider four possible models: (a) an epidemic that is increasing and [19] and apply the APE metric over 2 ≤ k ≤ t /2 with t as the last available 266 incidence time point. We compare the one-step-ahead I s+1 prediction fidelity 267 and the R τ (s) estimation accuracy obtained from the renewal model under the 268 APE-selected k * to that from the model used in [8] , which recommended weekly 269 windows (i.e. k = 7) after visually examining several window lengths. Our main 270 results are given in Fig. 6 and Fig. 7 . We benchmarked our estimates against The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. It . https://doi.org/10.1101/835181 doi: bioRxiv preprint Figure 4 : APE sensitivity to real-time transmission changes. We simulate 10 3 independent incidence curves under renewal models with reproduction numbers indicating (a) increasing, (b) controlled, (c) recovering and (d) cumulatively controlled epidemics. In each panel the top graphs give the true (green) and predicted (cyan) incidence ranges curves, the middle ones provide the estimate of R s under the final k * (t) and the bottom graphs illustrate how the successive k * (s) choices of the APE metric vary across time. We find that k * (s) responds rapidly to significant changes in the shape of the incidence curves. This makes it sensitive to important fluctuations in R s , especially those that force R s < 1. The APE metric is suitable for real-time applications and particularly useful for diagnosing the efficacy of control measures.
. CC-BY-NC-ND 4.0 International license is made available under a The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. It . https://doi.org/10.1101/835181 doi: bioRxiv preprint Fig. 6 . Between 8 − 10% of incidence data points are better covered by using 277 k * over k = 7. This improvement is apparent in the right graphs of (a) and 278 (b) in Fig. 7 , where the k = 7 case produces stiffer incidence predictions that 279 cannot properly reproduce the observed epi-curve. Weekly windows misjudge 280 the SARS epidemic peak, predict a multimodal SARS incidence curve that is 281 not reflected by the actual data and systematically underestimate influenza case 282 counts when it matters most (i.e. around the high incidence phase).
However, the smaller k * window results in noisier R τ (s) estimates (left graphs 284 of (a) and (b) in Fig. 7) , which may be questionable. These rapidly fluctuat- The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. It . https://doi.org/10.1101/835181 doi: bioRxiv preprint Figure 6 : Empirical prediction accuracy. We compare the APE metric (solid blue, left y axis) to the percentage of true incidence values, I s+1 , which fall outside the 95% prediction intervals of x | I s s−k+1 (dotted red, right y axis) across the window search space k. The dashed line gives k * (black) and k = 7 (grey). The top graph presents results for the influenza 1918 dataset, while the bottom one is for SARS 2003 data. We find that heuristic weekly windows lead to appreciably larger forecasting error than the APE selections.
We might suspect that certain artefacts of the data could resolve this issue, 295 rendering a more believable combination of estimated reproduction number and 296 predicted incidence. Particularly, the influenza data seems considerably more 297 affected by the smaller look-back windows. These k * = 2 windows are needed 298 to help predictions get close to the peak incidence values of the data. However, 299 these peaks seem reminiscent of outliers and in the original analysis of [17] they 300 were attributed to possible recollection bias in patients that were questioned.
Removing these biases might be expected to lead to smoother APE-justified 302 reproduction numbers. The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. It . https://doi.org/10.1101/835181 doi: bioRxiv preprint Figure 7 : Selection for empirical datasets. Left graphs of each panel com-pareR τ (s) estimates (cyan with 95% confidence intervals) at APE window length k * to those when k = 7 (weekly sliding windows). Right graphs give corresponding one-step-ahead predicted incidence curves (cyan with 95% prediction intervals). Dashed lines are the R = 1 threshold (left) and dots are the true incidence counts (right). The panels examine epi-data from outbreaks of (a) pandemic influenza (1918) and (b) SARS (2003), which are available in EpiEstim [8] . Panels (c) and (d) repeat (a) and (b) respectively, but smooth outliers in the incidence data using 5-day moving averages as in [17] . Interestingly, while k * leads to less believable reproduction number fluctuations, these are justified by the available data in both smoothed and un-smoothed cases. This hints that a Poisson renewal model may not be the most appropriate for these data. The longer weekly windows, which are heuristic recommendations of previous analyses [8] , miss important characteristics of the epi-curves.
. CC-BY-NC-ND 4.0 International license is made available under a The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. It . https://doi.org/10.1101/835181 doi: bioRxiv preprint variance equality that may limit the ability to properly predict incidence data to available epidemic data.
Our approach was founded on deriving an analytical expression for the re- . Grouping is therefore employed [8] .
This assumes that the reproduction number, denoted R τ (t) , is constant over 452 the past k time units [8] , and leads to a piecewise-constant function that classifies 453 between meaningful and negligible reproduction number changes. The grouped
, with parameter-independent prediction error up to the present t, which we term k * , gives the renewal model 496 that best predicts the unseen datum at t + 1.
We generally do not useÎ s+1 directly, but instead obtain its full predictive The optimal window, k * := arg min k APE k , is easy to compute provided the 503 predictive distribution in Eq. (9) is calculable. Fig. 1 as tailored to specific problems, both metrics converge when errors are normally 510 distributed [11] . Other score functions can be used with these one-step-ahead 511 predictions when application-specific insights are available [28] .
The APE metric has formal links to MDL and Bayesian model selection However, the APE is simpler and more transparent, requiring no difficult 521 integral evaluations [9] . Consequently, the APE not only accounts for parametric 522 complexity (implicitly), but also applies to models of arbitrary complexity [11] .
The drawbacks of APE are that it requires the data to be ordered in time, and 524 being data-driven, its computational complexity increases linearly in both the 
