While traditional microbiological freshwater tests focus on the detection of specific bacterial indicator species including pathogens, direct tracing of all aquatic DNA through metagenomics poses a profound alternative. Yet, in situ metagenomic water surveys face substantial challenges in cost and logistics. Here we present a simple, fast, inexpensive and remotely accessible freshwater diagnostics workflow centred around the portable nanopore sequencing technology. Using defined compositions and spatiotemporal microbiota from surface water of an example river in Cambridge (UK), we provide optimised experimental and bioinformatics guidelines, including a benchmark with twelve taxonomic classification tools for nanopore sequences. We find that nanopore metagenomics depicts both, the hydrological core microbiome and fine temporal gradients in line with complementary physicochemical measurements. Using reference-based sequence clustering, these data feature relevant sewage signals and pathogen maps at species level resolution. We anticipate that this framework will gather momentum for new environmental monitoring initiatives using portable devices. Extended Data Figure 2: Bioinformatics consensus workflow. Essential data processing steps, from nanopore sequencing to spatiotemporal bacterial composition analysis (Methods). After full-length 16S rDNA sequencing with the MinION (R9.4 flow cell), local basecalling of the raw fast5 files was performed using Guppy 69 . Output fastq files were filtered for length and quality (Methods), and reads assigned to their location barcode using Porechop. We then used Minimap2 15 (k = 15) and the SILVA v.132 database 16 for taxonomic classifications. Rarefaction reduced each sample to the same number of reads (37,000), allowing for a robust comparison of bacterial composition across samples in various downstream analyses. Extended Data Figure 3: Impact of rarefaction on diversity estimation. (a) Example rarefaction curve for bacterial family classifications of the 'April-1' sample. The chosen cut-off preserves most (~90 %) of the original family taxon richness (vertical line). (b) Difference between original and rarefied family richness at 37,000 reads across all freshwater sequencing runs with quantitative sequencing outputs above the chosen cut-off. Boxplots feature 100 independent rarefactions per sample. Error bars represent Q1 -1.5*IQR (lower), and Q3 + 1.5*IQR (upper), respectively. (c) Diversity visualisation of the ten most abundant bacterial families across all samples with sequencing outputs >37,000 reads, through 400 'unordered bubbles'. Taxonomic proportions and colours are in accordance with Figure 2b. Shannon (H) and Simpson (D) indices for all samples indicate marginal differences between pairs of original and rarefied sets. Extended Data Figure 4: Principal component analysis of river bacterial family compositions. (a-b) PCA
with two independent rarefaction sets to 37,000 reads in all freshwater sequencing samples. Numbers and coloured dots indicate locations for each time point. The first and second principal components (PC1 and PC2, combined variance: ~41 %) robustly capture outlier samples 'April-7' along PC1 and 'April-2', 'August-4' and 'April-8' along PC2. (c-d) Fractional loads of the ten bacterial families most strongly contributing to changes along PC1 (c) and along PC2 (d). Error bars represent standard deviation of these families to the respective PC across four independent rarefactions. Subsequent principal components (PC3 and PC4) are less outlier-driven and depict spatial and temporal metagenomic trends within the River Cam.
The global assurance of safe drinking water and basic sanitation has been recognised as a United Nations Millennium Development Goal 1 , particularly in light of the pressures of rising urbanisation, agricultural intensification and climate change 2,3 . These trends enforce an increasing demand for freshwater monitoring frameworks that combine cost effectiveness, fast technology deployability and data transparency 4 . Environmental metagenomics, the tracing of organisms present in a substrate through high-throughput DNA sequencing, yields informative measures of relative taxonomic species occurrence and functional diversity 5 . Microbial metagenomics studies overcome enrichment biases common to traditional culturing approaches 5 ; however, they usually depend on expensive and stationary equipment, highly specialised operational training and substantial time lags between fieldwork, sample preparation, raw data generation and access.
In recent years, these challenges have been revisited with the prospect of 'portable' DNA analysis. The main driver of this is the smartphone-sized MinION device from Oxford Nanopore Technologies (ONT), which enables real-time DNA sequencing using nanopores 6 . Nanopore read lengths can be comparably long (currently up to ~2*10 6 bases 7 ), which is enabled by continuous electrical sensing of sequential nucleotides along single DNA strands. In connection with a laptop or cloud access for the translation of raw voltage signal into nucleotides, nanopore sequencing can be used to rapidly monitor long DNA sequences in remote locations. Although there are still common concerns about the technology's base-level accuracy, mobile MinION setups have already proven powerful for real-time tracing and open data sharing during bacterial and viral pathogen outbreaks [8] [9] [10] [11] [12] [13] .
Here we report a simple, inexpensive workflow to assess microbial freshwater ecosystems with nanopore DNA sequencing. Our benchmark involves the design and optimisation of essential experimental steps for multiplexed MinION usage in the context of local environments, together with an evaluation of computational methods for the bacterial classification of nanopore sequencing reads from metagenomic libraries. To showcase the resolution of sequencing-based aquatic monitoring in a spatiotemporal setting, we combine DNA analyses with physicochemical measurements of surface water samples collected at nine locations within a confined ~12 kilometre reach of the River Cam passing through the city of Cambridge (UK) in April, June and August 2018.
Nanopore full-length (V1-V9) 16S ribosomal RNA (rRNA) gene sequencing was performed on all locationbarcoded freshwater samples at each of the three time points (Figure 1 ; Supplementary Table 1a ). Samples were complemented with a negative control (deionised water) and a mock community control composed of eight bacterial species in known mixture proportions (Methods).
To obtain valid taxonomic assignments from freshwater sequencing profiles using nanopore sequencing, twelve different classification tools were compared through several performance metrics (Extended Data Figure 1 ; Methods). Root mean square errors (RMSE) between observed and expected bacteria of the mock community differed slightly across all classifiers. An Enterobacteriaceae overrepresentation was observed across all replicates and classification methods, pointing towards a consistent Escherichia coli amplification bias potentially caused by skewed taxonomic specificities of the selected 16S primer pair (27f and 1492r) 14 . Robust quantifications were obtained by Minimap2 15 alignments against the SILVA v.132 database 16 , for which 99.68 % of classified reads aligned to the expected mock community taxa (mean sequencing accuracy 92.08 %). Minimap2 classifications reached the second lowest RMSE (excluding Enterobacteriaceae), and relative quantifications were highly consistent between mock community replicates. Benchmarking of the classification tools on one aquatic sample further confirmed Minimap2's reliable performance in a more complex bacterial community, although other tools such as SPINGO 17 , MAPseq 18 , or IDTAXA 19 also produced highly concordant results despite variations in processing speed and memory usage (data not shown).
Using Minimap2 classifications within our bioinformatics consensus workflow (Extended Data Figure 2 ;
Methods), we then inspected sequencing profiles of three independent MinION runs for a total of 30 river DNA isolates and six controls. This yielded ~8. 3 and Rhodobacteraceae (2.5 %) (Figure 2d ). Members of these families are commonly associated with aquatic environments; for example, Burkholderiaceae reads mostly originate from genera such as Limnohabitans, Rhodoferax or Aquabacterium, which validates the suitability of this nanopore metagenomics workflow.
Hierarchical clustering additionally showed that two biological replicates collected at the same location and time point (April samples 9.1 and 9.2), grouped with high concordance; this indicates that spatiotemporal trends are discernible even within a highly localised context. Besides the dominant core microbiome, microbial profiles showed a marked arrangement of time dependence, with water samples from April grouping more distantly to those from June and August (Figure 2c ). Principal component analysis (PCA) (Figure 3a ; Extended Data Figure   4 ) revealed that the strongest differential abundances along the chronological axis of variation (PC3) derived from the higher abundance of Carnobacteriaceae in April (Figure 3b ). This family is known for its occurrence in waters with low temperature 20 .
While a seasonal difference in bacterial composition can be expected due to increasing water temperatures in the summer months, additional changes may have also been caused by alterations in river hydrochemistry and flow rate (Extended Data Figures 5 and 6 , respectively; Supplementary Table 1c) . To assess this effect in detail, we measured the pH and a range of major and trace cations in all river water samples using inductively coupled plasma-optical emission spectroscopy (ICP-OES), as well as major anions using ion chromatography (Extended Data Figure 5 ; Methods). As with the bacterial composition dynamics, we observed significant temporal variation in water chemistry, superimposed on a spatial gradient of generally increasing sodium and chloride concentrations along the river reach. This spatially consistent effect is likely attributed to wastewater and agricultural discharge inputs in and around Cambridge city. A comparison of the major element chemistry in the River Cam transect with the world's 60 largest rivers further corroborates the likely impact of anthropogenic pollution in this fluvial ecosystem 21 (Extended Data Figure 5 ; Methods).
In line with these physicochemical trends, we next determined the spatiotemporal enrichment of potentially functionally important bacterial taxa through nanopore sequencing. We retrieved 55 potentially pathogenic bacterial genera through careful integration of species known to affect human health 22, 23 , and also 13 wastewaterassociated 24 bacterial genera (Supplementary Table 3 ). Of these, 21 potentially pathogenic and eight wastewaterassociated genera were detected across all of the river samples (Figure 3c ; Methods). Many of these signals were stronger downstream of urban sections, within the mooring zone for recreational and residential barges (location 7, Figure 1a ) and in the vicinity of sewage outflow from a nearby wastewater treatment plant (location 8). The most prolific candidate pathogen genus observed was Arcobacter, which features multiple species implicated in acute gastrointestinal infections 25 .
In general, much of the taxonomic variation across all samples was caused by sample April-7 (PC1 explains 27. Using multiple sequence alignments between nanopore reads and pathogenic species references, we further resolved the phylogenies of three common potentially pathogenic genera occurring in our river samples, Pseudomonas, Legionella and Salmonella (Extended Data Figure 7 ; Methods). While Legionella and Salmonella diversities only presented negligible levels of known harmful species, a cluster of sequencing reads in downstream sections indicated a low abundance of the opportunistic, environmental pathogen Pseudomonas aeruginosa (Extended Data Figure 7 ).
We also found significant variations in relative abundances of the Leptospira genus, which was recently described to be enriched in wastewater effluents in Germany 27 . Indeed, the peak of River Cam Leptospira reads falls into an area of increased sewage influx (Figure 3c ). The Leptospira genus contains several potentially pathogenic species capable of causing life-threatening leptospirosis through waterborne infections 28 , however also features closerelated saprophytic and 'intermediate' taxa 29 . To resolve its complex phylogeny in the River Cam surface, we aligned Leptospira reads from all samples together with various reference sequences assigned to pre-classified pathogenic, saprophytic and other environmental Leptospira species 29 (Figure 3d ; Supplementary Table 4a; Methods). Despite the presence of nanopore sequencing errors (Extended Data Figure 8 ) and correspondingly inflated read divergence, we could pinpoint spatial clusters and a distinctly higher similarity between our amplicons and saprophytic rather than pathogenic Leptospira species. These findings were subsequently validated by targeted, Leptospira species-specific qPCR (Supplementary Table 5 , Methods), confirming that the latest nanopore sequencing quality is high enough to yield indicative results for bacterial monitoring workflows at the species level.
Using an inexpensive, easily adaptable and scalable framework, we provide the first spatiotemporal nanopore sequencing atlas of bacterial microbiota along a river reach. Beyond the core microbiome of an example fluvial ecosystem, our results suggest that it is possible to robustly assess the heterogeneity in accessory bacterial composition in the context of supporting physical (temperature, flow rate) and hydrochemical (pH, inorganic solutes) parameters. We show that the technology's current accuracy of ~92 % allows for the designation of significant human pathogen community shifts along rural-to-urban river transitions, as illustrated by downstream increases in the abundance of pathogen candidates.
Furthermore, our assessment of popular bioinformatics workflows for taxonomic classification highlights current challenges with error-prone nanopore sequences. We observed differences in terms of bacterial quantifications, read misclassification rates and consensus agreements between the twelve tested computational methods. In this computational benchmark, using the SILVA v.132 reference database, one of the most balanced performances was achieved by Minimap2 alignments. As nanopore sequencing quality continues to increase through refined pore chemistries, basecalling algorithms and consensus sequencing workflows [30] [31] [32] , future bacterial taxonomic classifications are likely to improve and advance opportunities for aquatic species discovery.
We show that nanopore amplicon sequencing data can resolve the core microbiome of a freshwater body, as well as its temporal and spatial fluctuations. Besides common freshwater bacteria, we find that the differential abundances of Carnobacteriaceae most strongly contribute to seasonal loadings in the River Cam.
Carnobacteriaceae have been previously associated with cold environments 20 , and we found these to be more abundant in colder April samples (mean 11.3 °C, vs. 15.8 °C in June and 19.1 °C in August). This might help to establish this family as an indicator for bacterial community shifts along with water temperature fluctuations.
Most routine freshwater surveillance frameworks focus on semi-quantitative diagnostics of only a limited number of target taxa, such as pathogenic Salmonella, Legionella and faecal coliforms 33, 34 . Our proof-of-principle analysis highlights that the combination of full-length 16S rRNA gene amplification and nanopore sequencing can complement hydrochemical controls in pinpointing relatively contaminated freshwater sites, some of which had been previously highlighted for their pathogen diversity and abundance of antimicrobial resistance genes 35, 36 .
Nanopore sequencing here allowed for the reliable distinction of closely related pathogenic and non-pathogenic bacterial species of the common Salmonella, Legionella, Pseudomonas and Leptospira genera. For Leptospira bacteria, we further validated nanopore sequencing results through the gold standard qPCR workflow of Public Health England (Supplementary Table 5 ).
A number of experimental intricacies should be addressed towards future nanopore freshwater sequencing studies, mostly by scrutinising water DNA extraction yields, PCR biases and molar imbalances in barcode multiplexing ( Figure 2a ; Extended Data Figure 8 ). Yet, our results show that it would be theoretically feasible to obtain meaningful river microbiota from >100 barcoded samples on a single nanopore flow cell, thereby enabling water monitoring projects involving large collections at costs below £20 per sample (Supplementary Table 6 ). Barcoded shotgun nanopore sequencing protocols may pose a viable alternative strategy to bypass pitfalls often observed in amplicon-based workflows, namely taxon-specific primer biases 14 Competing interests: All authors of this manuscript declare no competing interest.
Stammnitz (maxrupsta@gmail.com), or to Andre Holzer (andre.holzer.biotech@gmail.com) and Lara Urban (lara.h.urban@gmail.com)
. CC-BY-ND 4.0 International license author/funder. It is made available under a The copyright holder for this preprint (which was not peer-reviewed) is the . https://doi.org/10.1101/2020.02.06.936302 doi: bioRxiv preprint The copyright holder for this preprint (which was not peer-reviewed) is the . https://doi.org/10.1101/2020.02.06.936302 doi: bioRxiv preprint The copyright holder for this preprint (which was not peer-reviewed) is the . https://doi.org/10.1101/2020.02.06.936302 doi: bioRxiv preprint The copyright holder for this preprint (which was not peer-reviewed) is the . https://doi.org/10.1101/2020.02.06.936302 doi: bioRxiv preprint Q1 -1.5*IQR (lower), and Q3 + 1.5*IQR (upper), respectively; Q1: first quartile, Q3: third quartile, IQR: interquartile range. The centre colour-scale table depicts the categorisation of subsets of genera as waterborne bacterial pathogens (WB), drinking water pathogens (DWP), potential drinking water pathogens (pDWP), human pathogens (HP) and core genera from wastewater treatment plants (WW) (dark grey: included, light grey: Table 3 ). The right-hand circle plot shows the distribution of bacterial genera across locations of the River Cam. Circle sizes represent overall read size fractions, while circle colours (sigma scheme) represent the standard deviation from the observed mean relative abundance within each genus. (d) Phylogenetic tree illustrating the multiple sequence alignment of all nanopore reads classified as Leptospira, together with known Leptospira reference sequences ranging from pathogenic to saprophytic species 29 (Supplementary Table   4a ). The copyright holder for this preprint (which was not peer-reviewed) is the . https://doi.org/10.1101/2020.02.06.936302 doi: bioRxiv preprint MATERIALS AND METHODS
We monitored nine distinct locations along a 11.62 km reach of the River Cam, featuring sites upstream, downstream and within the urban belt of the city of Cambridge, UK. Measurements were taken at three time points, in two-month intervals between April and August 2018 (Figure 1; Supplementary Table 1a ). To warrant river base flow conditions and minimise rain-derived biases, a minimum dry weather time span of 48h was maintained prior to sampling 51 . One litre of surface water was collected in autoclaved DURAN bottles (Thermo Fisher Scientific, Waltham, MA, USA), and cooled to 4 °C within three hours. Two bottles of water were collected consecutively for each time point, serving as biological replicates of location 9 (samples 9.1 and 9.2).
We assessed various chemical, geological and physical properties of the River Cam (Extended Data Figures 5 and   6 , Supplementary Tables 1b and 1c) .
In situ water temperature was measured immediately after sampling. To this end, we linked a DS18B20 digital temperature sensor to a portable custom-built, grid mounted Arduino nano v3. The copyright holder for this preprint (which was not peer-reviewed) is the . https://doi.org/10.1101/2020.02.06.936302 doi: bioRxiv preprint indicated precision of more than 4 % for Cl -. However, the high Clconcentrations of the samples in this study were not fully bracketed by the calibration curve and we therefore assigned a more conservative uncertainty of 10 % to Clconcentrations.
High calcium and magnesium concentrations were recorded across all samples, in line with hard groundwater and natural weathering of the Cretaceous limestone bedrock underlying the river catchment (Extended Data Figure 5 ).
There are no known evaporite salt deposits in the river catchment, and therefore the high dissolved Na + , K + and Clconcentrations in the River Cam are likely derived from anthropogenic inputs 52 (Extended Data Figure 5 ). We The total dissolved solid (TDS) concentration across the 30 freshwater samples had a mean of 458 mg/L (range 325 -605 mg/L) which is relatively high compared to most rivers, due to 1.) substantial solute load in the Chalk groundwater (particularly Ca 2+ , Mg 2+ , and HCO3 -) and 2.) likely anthropogenic contamination (particularly Na + , Cl -, and SO4 2-). The TDS range and the major ion signature of the River Cam is similar to other anthropogenically heavily-impacted rivers 21 , exhibiting enrichment in Na + (Extended Data Figure 5 ).
Overall, ion profiles clustered substantially between the three time points, indicating characteristic temporal shifts in water chemistry. PC1 of a PCA on the solute concentrations [µmol/L] shows a strong time effect, separating spring (April) from summer (June, August) samples (Extended Data Figure 5b) . We highlighted the ten most important features (i.e., features with the largest weights) and their contributions to PC1 (Extended Data Figure   5c ).
We integrated sensor data sets on mean daily air temperature, sunshine hours and total rainfall from a public, The copyright holder for this preprint (which was not peer-reviewed) is the . https://doi.org/10.1101/2020.02.06.936302 doi: bioRxiv preprint
Within 24 hours of sampling, 400 mL of refrigerated freshwater from each site was filtered through an individual 0.22 µm pore-sized nitrocellulose filter (MilliporeSigma, Burlington, MA, USA) placed on a Nalgene polysulfone bottle top filtration holder (Thermo Fisher Scientific) at -30 mbar vacuum pressure. Additionally, 400 mL deionised (DI) water was also filtered. We then performed DNA extractions with a modified DNeasy PowerWater protocol (Qiagen, Hilden, Germany). Briefly, filters were cut into small slices with sterile scissors and transferred to 2 mL Eppendorf tubes containing lysis beads. Homogenization buffer PW1 was added, and the tubes subjected to ten minutes of vigorous shaking at 30 Hz in a TissueLyser II machine (Qiagen). After subsequent DNA binding and washing steps in accordance with the manufacturer's protocol, elution was done in 50 µL EB. We used Qubit dsDNA HS Assay (Thermo Fisher Scientific) to determine water DNA isolate concentrations (Supplementary Table 2a ).
DNA extracts from each sampling batch and DI water control were separately amplified with V1-V9 full-length Figure 1b-c) , which was previously assessed using nanopore shotgun metagenomics 42 . We used common primer binding sequences 27f and 1492r, both coupled to unique 24 bp barcodes and a nanopore motor protein tether sequence (Supplementary Table 7 ). Fulllength 16S rDNA PCRs were performed with the following conditions: Table S2b ). We used KAPA Pure Beads (KAPA Biosystems, Wilmington, MA, USA) to concentrate full-length 16S rDNA products in 21 µL DI water. Multiplexed nanopore ligation sequencing libraries were then made by following the SQK-LSK109 protocol (Oxford Nanopore Technologies, Oxford, UK).
R9.4 MinION flow cells (Oxford Nanopore Technologies) were loaded with 75 µl of ligation library. The MinION instrument was run for approximately 48 hours, until no further sequencing reads could be collected. Fast5 files were basecalled using Guppy (version 3.15) and output DNA sequence reads with Q>7 were saved as fastq files.
Various output metrics per library and barcode are summarised in Supplementary Table 2c .
In collaboration with Public Health England, raw water DNA isolates of the River Cam from each location and time point were subjected to the UK reference service for leptospiral testing (Supplementary Table 5 ). This test is based on quantitative real-time PCR (qPCR) of 16S rDNA and LipL32, implemented as a TaqMan assay for the detection and differentiation of pathogenic and non-pathogenic Leptospira spp. from human serum. Briefly, the assay consists of a two-component PCR; the first component is a duplex assay that targets the gene encoding the outer membrane lipoprotein LipL32, which is reported to be strongly associated with the pathogenic phenotype.
The second reaction is a triplex assay targeting a well conserved region within the 16S rRNA gene (rrn) in 
The described data processing and read classification steps were implemented using the Snakemake workflow management system 53 and are available on Github -together with all necessary downstream analysis scripts to reproduce the results of this manuscript (https://github.com/d-j-k/puntseq). We gathered read statistics such as quality scores and read lengths using NanoStat (version 1.1.2, https://github.com/wdecoster/nanostat), and used Pistis (https://github.com/mbhall88/pistis) to create quality control plots. This allowed us to assess GC content and Phred quality score distributions, which appeared consistent across and within our reads. Overall, we obtained 2,080,266 reads for April, 737,164 for June, and 5,491,510 for August, with a mean read quality of 10.0 (Supplementary Table 2c ).
We used twelve different computational tools for bacterial full-length 16S rDNA sequencing read classification 
We used nanopore sequencing data from our mock community and freshwater amplicons for benchmarking the classification tools. We therefore subsampled (a) 10,000 reads from each of the three mock community sequencing replicates (section 1.4), and (b) 10,000 reads from an aquatic sample (April-8; three random draws served as replicates). We then used the above twelve classification tools to classify these reads against the same database,
SILVA v.132 16 (Extended Data Figure 1 ).
For the mock community classification benchmark, we assessed the number of unclassified reads, misclassified reads (i.e. sequences not assigned to any of the seven bacterial families), and the root mean squared error (RMSE) between observed and expected taxon abundance of the seven bacterial families. Following the detection of a strong bias towards the Enterobacteriaceae family across all classification tools, we also analysed RMSE values after exclusion of this family (Extended Data Figure 1b -c).
For the aquatic sample, the number of unclassified reads were counted prior to monitoring the performance of each classification tool in comparison with a consensus classification, which we defined as majority vote across classifications from all computational workflows. We observed stable results across all three draws of 10,000 reads from the same dataset (data not shown), indicating a robust representation of the performance of each classifier.
Minimap2 performed second best at classifying the mock community (lowest RMSE), while also delivering freshwater bacterial profiles in line with the majority vote of other classification tools (Extended Data Figure 1d e), in addition to providing rapid speed (data not shown). Yet, the application of this software to our entire dataset caused insufficient memory errors (at ~150 Gb RAM with kmer length 12), likely due to major sequence redundancies within the SILVA v.132 reference fasta file. Therefore, to run each of our full samples within a reasonable memory limit of 50 Gb, it was necessary to reduce the number of threads to 1, raise the kmer size ('k') to 15 and set the minibatch size ('-K') to 25M (i.e., the number of query bases that are processed at any time), prolonging the runtime of several samples to ~three days.
After applying Minimap2 to the processed reads as explained above (section 2.2.4), we processed the resulting SAM files by firstly excluding all header rows starting with the '@' sign and then transforming the sets of read IDs, SILVA IDs, and alignment scores to TSV files of unique read-bacteria assignments either on the bacterial genus or family level. All reads that could not be assigned to the genus or family level were discarded, respectively.
In the case of a read assignment to multiple taxa with the same alignment score, we determined the lowest taxonomic level in which these multiple taxa would be included. If this level was above the genus or family level, respectively, we discarded the read.
Across three independent sequencing replicates of the same linear bacterial community standard (section 2.2.1),
we found that the fraction of reads assigned to unexpected genus level taxa lies at ~1 % when using the Minimap2 classifier and the SILVA v.132 database.
Raw quantified DNA, PCR amplicons and sequencing read counts were considerably less abundant in DI water negative controls, as compared to actual freshwater specimens (Supplementary Table 2a Table 8 ).
Minimap2 alignments against mock community taxa were used to determine the mean read-wise nanopore sequencing accuracy for this study, as determined by the formula: accuracy = 1 -(read mismatch length ÷ read alignment length)
These values were calculated for each of all eight species against each sequencing replicate, using the samtools 66 (v.1.3.1) stats function.
Sample-specific rarefaction curves were generated by successive subsampling of sequencing reads classified by Figure 3 ; section 2.4.1). Although we mainly present a single example rarefied dataset within this manuscript, we repeated each analysis, including PCAs, hierarchical clustering and Mantel tests, based on additional rarefied datasets to assess the stability of all results.
We performed Mantel tests (using scikit-bio version 0.5.1) to compare rarefied datasets with the full dataset. We 
All classification assessment steps and summary statistics were performed in R or python (https://github.com/dj-k/puntseq). We used the python package 'scikit-bio' for the calculation of the Simpson index and the Shannon's diversity as well as equitability index.
. CC-BY-ND 4.0 International license author/funder. It is made available under a The copyright holder for this preprint (which was not peer-reviewed) is the . https://doi.org/10.1101/2020.02.06.936302 doi: bioRxiv preprint
Rarefied read count data was subjected to a log10(x+1) transformation before hierarchical clustering using the complete linkage method. For PCA analyses, rarefied read count data was subjected to log10(x+1) and Ztransformations. Negative control samples were removed. Mock community samples were initially removed to then be re-aligned to the eigenspace determined by the aquatic samples. We provide PCA visualisations of the main principal components (PCs explaining >10 % variance, respectively). For each of these relevant PCs, we further highlight the ten most important features (i.e., taxa with the largest weights) and their contributions to the PCs in barplots.
For detecting outlier bacterial families per sample, we chose bacteria which were 1.) identified by more than 500 reads and 2.) which were at least five times more abundant in any single sample than in the mean of all samples combined.
A list of 55 known bacterial pathogenic genera, spanning 37 families, was compiled for targeted sequence testing.
This was done through the careful integration of curated databases and online sources, foremost using PATRIC 22 and data on known waterborne pathogens 23 (Supplementary Table 3a ). Additionally, we integrated known genera from a large wastewater reference collection 24 (Supplementary Table 3b ).
To identify if DNA reads assigned to Leptospiraceae were more similar to sequence reads of previously identified pathogenic, intermediate or environmental Leptospira species, we built a neighbour-joining tree of Leptospiraceae reads classified in our samples data, together with sequences from reference databases (Figure 3d ; species names and NCBI accession numbers in clockwise rotation around the tree in Supplementary Table 4a ). We matched the orientation of our reads, and then aligned them with 68 Leptospira reference sequences and the Leptonema illini reference sequence (DSM 21528 strain 3055) as outgroup. We then built a neighbour-joining tree using Muscle v.3.8.31 67 (excluding three reads in the 'Other Environmental' clade that had extreme branch lengths >0.2). The reference sequences were annotated as pathogenic and saprophytic clades P1, P2, S1, S2 as recently described 29 .
Additional published river water Leptospira that did not fall within these clades were included as 'Other Environmental' 68 . Similarly, we constructed phylogenies for the Legionella, Salmonella and Pseudomonas genus, using established full-length 16S reference species sequences from NCBI (Supplementary Table 4b-d).
This study was designed to enable freshwater microbiome monitoring in budget-constrained research environments. Although we had access to basic infrastructure such as pipettes, a PCR and TissueLyser II machine, as well a high-performance laptop, we wish to highlight that the total sequencing consumable costs were held below £4,000 (Supplementary Table 6a ). Here, individual costs ranged at ~£75 per sample (Supplementary Table   6b ). With the current MinION flow cell price of £720, we estimate that per-sample costs could be further reduced to as low as ~£15 when barcoding and pooling ~£100 samples in the same sequencing run (Supplementary Table   6c ). Assuming near-equimolar amplicon pooling, flow cells with an output of ~5,000,000 reads can yield well over 37,000 sequences per sample and thereby surpass this conservative threshold applied here for comparative river microbiota analyses.
Sequencing datasets generated and analysed during this study are available from the European Nucleotide The are no restrictions on data availability.
Our Github repository (https://github.com/d-j-k/puntseq/) provides a Snakemake framework that integrates all data pre-processing steps, and a Singularity that contains all necessary software (https://github.com/d-jk/puntseq/tree/master/analysis/). We further provide complete and rarefied SILVA 132 classifications from runs of Minimap2 (https://github.com/d-j-k/puntseq/tree/master/minimap2_classifications), which can be directly used as an input for downstream analyses.
. CC-BY-ND 4.0 International license author/funder. It is made available under a The copyright holder for this preprint (which was not peer-reviewed) is the . https://doi.org/10.1101/2020.02.06.936302 doi: bioRxiv preprint (a-b) List of pathogen (a) and wastewater (b) candidate bacterial genera. and August (c).
. CC-BY-ND 4.0 International license author/funder. It is made available under a The copyright holder for this preprint (which was not peer-reviewed) is the . https://doi.org/10.1101/2020.02.06.936302 doi: bioRxiv preprint
