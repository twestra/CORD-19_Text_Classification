Animal relocation data has recently become considerably more ubiquitous, finely structured (collection frequencies measured in minutes) and co-variate rich (physiology of individuals, environmental and landscape information, and accelerometer data). To better understand the impacts of ecological interactions, individual movement and disease on global change ecology, including wildlife management and conservation, it is important to have simulators that will provide demographic, movement, and epidemiology null models against which to compare patterns observed in empirical systems. Such models may then be used to develop quantitative narratives that enhance our intuition and understanding of the relationship between population structure and generative processes: in essence, along with empirical and experimental narratives, quantitative narratives are used to advance ecological epistemology. Here we describe a simulator that accounts for the influence of consumer-resource interactions, existence of social groups anchored around a central location, territoriality, group-switching behavior, and disease dynamics on population size. We use this simulator to develop new and reinforce existing quantitative narratives and point out areas for future study.
The health and viability of species are of considerable concern to all nature lovers. Population models are central to our efforts to assess the numerical and ecological status of species and threats posed by climate change. Models, however, are crude caricatures of complex ecological systems. So how do we construct reliable assessment models able to capture processes essential to predicating the impacts of global change on population viability without getting tied up in their vast complexities? We broach this question and demonstrate how models focusing at the level of the individual (i.e., agent-based models) are tools for developing robust, narratives to augment narratives arising purely from empirical data sources and experimental outcomes. We do this in the context of nesting social groups, foraging for food, while exhibiting territoriality and group-switching behavior; and, we evaluate the impact of disease on the viability of such populations. 7 laboratory at the microcosm scale [7], but for populations of most vertebrates such 8 microcosm studies are not applicable, and we need to resort to the mesocosm level [8] or 9 use alternative methods to obtain insights. One of these methods is to build simulation 10 models that incorporate demographic, spatial, movement, and other relevant behavioral 11 and community processes, and then compare simulations of these models across various 12 scenarios [9] or outcomes with and without epidemiological processes added to the mix. 13 We take this latter approach and our primary aim is to develop a tool that can be used 14 to study the impact of disease on colonial populations and metapopulations [10] . This 15 tool must be comprehensive enough to include critical processes needed to address 16 questions that will extend our current knowledge in significant ways. Its application, of 17 course, is limited by the structure of the model. Thus, in building the model, we are 18 guided by principles related to concepts of "appropriate complexity modeling" [11, 12] .
The standard approach to modeling disease outbreaks caused by 20 directly-transmitted pathogens is through systems of differential or difference equations 21 that model the number or density of susceptible (S), infectious (I), and recovered or 22 removed (R) individuals [13, 14]. These formulations may either be deterministic or 23 stochastic, and elaborated to include time-delays [15], demographic (births, deaths, and 24 recruitment [16]), metapopulation [17] and other spatial processes [18]. Examples of 25 these elaborations can be found in the context of modeling, inter alia, influenza [19, 20], 26 measles [21], SARS [22, 23], and Ebola [24-28] outbreaks.
27 Systems approaches to modeling disease limit our ability to consider individual-level 28 traits, unless these traits can be reasonably well expressed by dividing the population 29 into a limited number of subgroups, such as groups of individuals infected with different 30 strains of pathogens [29]. Including individual-level variation in disease models, however, 31 requires an agent-based approach [30], which then allows both individual behavior (e.g., 32 relevant to evaluating the probability of pathogen transmission) and pathogen exposure 33 history (e.g., relevant to evaluating the immunological state and hence the susceptibility 34 of an individual) to be incorporated into the model. It also allows one to trace the 35 number of individuals the each pathogen infects [25] and, hence, to identify individuals 36 that may be acting as super-spreaders [31].
Here, we develop an agent-based formulation that has application to studying 38 disease outbreaks in wildlife populations whose state of health-and hence, 39 susceptibility-is impacted by various factors, including social factors related to group 40 living and the structure of social networks [32], ecological factors related to foraging 41 success, and the movement behavior of individuals (which influences exposure to 42 pathogens). The model also includes a periodic return to a colony or nest cell, which 43 implies that the model has both a population-level and a group-association level (core 44 or household) structure. Such models have applications in animal production systems 45 (e.g., managing foot and mouth disease [33]), wildlife conservation [2], and disease 46 management at the human-animal interface [34]. The latter involves diseases such as 47 anthrax [35], bovine tuberculosis [36], and brucellosis in cattle and wild ungulates [37], 48 chronic wasting disease in deer [38], and toxoplasmosis in rats, cats and humans [39]. 49 Rather then following a formulaic ODD (Overview, Design concepts, and Design 50 details; [30, 40]) or extended ODD [41] prescription in presenting our model, we take a 51 more expository approach by first crafting a broad outline of our model's general 52 October 1, 2019 2/28 All rights reserved. No reuse allowed without permission.
The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. . https://doi.org/10.1101/791400 doi: bioRxiv preprint features. In addition, to keep the paper reader-friendly, we relegate the mathematical 53 details of our model to a Technical Methods section at the end of the paper and the 54 algorithmic details to a supporting online file (SOF). In the Results section, we report 55 the results of simulations of several illustrative scenarios, and in the Discussion section 56 we present the findings in the form of a quantitative narrative that provides insights 57 into the role different processes play in creating the population patterns observed in our 58 simulations.
At this point, a few brief remarks on quantitative narratives in disease ecology are in 60 order. Unlike the canonical theories of physics-with kinematics, electromagnetism, 61 general relativity, and quantum mechanics providing prime examples, ecology has no 62 fundamental theories and associated mathematical formulations that can be used to 63 develop an ecological epistemology. Rather, the complexity of the field induced by the 64 plethora of processes involved requires that we focus only on a limited number of these 65 processes when building models, where the selection of process depends on the questions 66 at hand [11]. Our understanding of these processes requires an analysis of associated 67 quantitative formulations, but the soundness of the arguments cannot be adjudicated by 68 comparing, say, the accuracy of Mercury's orbit as predicted by Newtonian versus 69 Einsteinian physics. Rather, ecological epistemology is woven from a collection of 70 quantitative narratives that provide current best explanations for, or fits to, observed 71 empirical and experimental data. While statistical null models are use to develop 72 consilient empirical and experimental narratives, dynamic null models are used to 73 develop quantitative narratives that are consilient with empirical and experimental 74 narratives (Fig. 1). Such dynamic null models have a Goldilocks quality in the sense of 75 containing just the right amount of biological process detail [42]: too little and model 76 simulations are rejected as providing adequate descriptions of observed data; too much 77 process detail and the null-model-parsimony principle, as discussed by Gotteli and 78 Graves ( [42], p. 6), is violated. 79 Fig 1. A sketch of the role of empirical, experimental and quantitative narratives in the formulation of canons and construction of syntheses in the development of an ecological epistemology.
In ecology, quantitative narratives, derived from the Gause-Lotka-Volterra 80 competition model, were used to construct the concept of a niche [43]. This narrative 81 begins with insights into competitive exclusion [44, 45], supported by additional 82 quantitative ideas relating to niche breadth and overlap [46, 47]. In epidemiology, 83 quantitative narratives, derived from analyses of SEIR epidemic models (S: susceptible; 84 E: exposed but not yet infectious; I: infections; R: removed-that is, recovered with 85 immunity or dead) [13] , have been used to identify critical differences in the emergence 86 of outbreak thresholds depending on whether pathogen transmission is dependent on quantitative narratives in epidemiology that incorporate aspects of the movement of 89 individuals [50] or particular ecological processes have been used to develop canonical 90 theories [51][52][53][54][55]; however, these are limited in scope and generality by the analytical 91 difficulties of studying dynamical systems, as well as networks that include more than 92 one ecological or behavioral process. The challenge here is to keep the models somewhat 93 general and broadly applicable, while including several key processes such as: spatial 94 demography; consumer-resource ecology with associated reproduction, growth, stress, 95 and mortality processes; movement and contact behavior; and SEIR epidemiology, in 96 ways that are simple enough to interpret the effects of each process. Sensitivity analyses 97 provide one type of approach to separating out effects [56][57][58][59]. Another is to use 98 methods relating to the practice of appropriate complexity modeling [11, 12] .
2 Methods
The model we present here only incorporates the focal processes of interest and those 101 needed to attain a level of realism required to adequately address the questions at hand. 102 Thus, for example, we do not include agent age structure in the model even though age 103 structure is known to have important effects on population growth patterns [60], 104 persistence [61], and epidemics [62]. Agent age structure would certainly add complexity 105 to our narratives; but, whether its impacts are critical (i.e., it qualitatively changes the 106 structures we explain) or only elaborative (i.e., has quantitative but not qualitative 107 implications regarding the questions asked) is a issue to be examined in future studies. 108 For clarity, we enumerate below-without mathematical details-the processes 109 incorporated in our model, leaving such details to the Technical Methods Section at the 110 end of the paper. Aspects of the Numerus Model Builder construction of the model and 111 the generated NovaScript (extended JavaScript language) implementation are provided 112 in a Supporting Information file. 113 2.1 Model Outline 114
The model is formulated as a set of agents (individuals) moving over a cellular array.
The agents themselves can be differentiated with respect to type (e.g., sex), can undergo 116 discrete state transitions (e.g., disease state) and can also change continuously over time 117 with respect an agent-level state vector. In our case, the latter contains the variables 118 "mass" (also a surrogate for fitness) and "stress" (which accumulates when the individual 119 is unable to meet its resource needs each time period). The cells in the cellular array 120 may also have relatively complex states that, in our model, include a list of the agents 121 in each cell and the level of a dynamically responding resource, which determines the 122 environmental context for the agents. Movement of agents occurs under the assumption 123 that, apart from reproduction, ecological and epidemiological processes are independent 124 of agent type. More specifically, in our model, the following objects and concepts apply: 125 Simulation world. This is the set of agents moving over a hexagonal cellular array 126 (we use a toroidal topology to eliminate boundary effects).
1 Disease ecology is a rich field of study that synthesizes inter alia demographic, epidemic, 2 behavioural, movement, spatial and community processes in an ecological setting [1] [2] [3] [4] [5] [6] . 3 Thus, understanding the impact of particular diseases on wild populations in ecological 4 settings is a challenge that requires a comparison of the spatial and community structure 5 of these focal populations, as they might arise in the absence versus the presence of the 6 causative agents of the diseases of interest. One can undertake such studies in the Time. The action takes place over discrete time steps during which individuals (agents) 133 move through one or more cells, stay in a cell to exploit resources, or return to 134 their colony cell at regular intervals of time where they may reproduce. 135 Agents. Each agent has a biomass (which is a surrogate measure of its fitness), a 136 stress level, and a sex determined at birth. Females may reproduce on regular 137 returns back to their colonies by, essentially, fissioning into two (the parent retains 138 the majority of the biomass, while the offspring acquires the minority of biomass, 139 with some loss due to the cost of reproduction). limitations are assumed), provided they are sufficiently fit (i.e., large) and not too 164 stressed. Individuals die at a natural-mortality specified rate, plus an additional 165 disease-induced-mortality rate during their infectious period. 166 Fission-fusion. Individuals moving into a cell that contains a colony, will join the 167 group associated with that colony with a particular probability provided their own 168 colony is some specified ratio larger than their current colony. Epidemiology. We allow individuals to cycle through an S (susceptible), E (exposed 176 but not yet infectious), I (infectious), V (immune), S cycle at rates respectively period. Individuals in all stages are subject to a natural mortality rate, while 180 individuals in the I stage are subject to an additional disease-induced mortality 181 rate. 182 
The mathematical equations are provided in Section 6, which are placed at the end of 184 the manuscript because it is not necessary to go through these details before the 185 presentation and discussion of our simulation results (those wishing to see the equations 186 before the results should read Section 6 before starting Section 3). These equations were 187 used to code the model using the Numerus Model Builder (NMB) platform that greatly 188 facilitated rapid, accurate construction of the model through NMB's hierarchical 189 architecture and chip design. More specifically, cell equations and agent equations were 190 first constructed as individual modules, which were then used to populate a "world" 191 with an open-ended number of agents moving over an 18×18 hexagonal cellular array 192 that contained 9 regularly spaced nest cells (Fig. 1) . A toroidal topology was used to 3.1 Base-line scenario: no disease, no colony switching 218 We ran two instances of the baseline scenario and obtained similar results with some 219 stochastic variation across runs. A plot of the number of agents N t over time (all are in 220 the susceptible disease state) for the the two runs is provided in Fig. 3 and can are seen 221 to be close in both period and amplitude. We note that our baseline scenario places us 222 at a particular point in the consumer-resource growth-rate, extraction, and interaction 223 parameter value space of our model. Table 3 ). The top left graphic panel depicts the 18 × 18 hexagonal landscape: colony nest cells are indicated using fully saturated colors and their territory cells using corresponding partially saturated colors (note "boundary spillover" effects due to the toroidal landscape topology). The number of individuals in each colony at time t = 1959 are plotted in the central bar graph, using matching colony nest-cell colors. decrease the mutual interference level (parameter q in Eq. 6) from 1 (resource extraction 228 inefficiencies due to self and others are proportional to the total biomass of all agents in 229 cells) to 0 (inefficiencies arise only from self) or increase it to 10 (inefficiencies increase 230 ten fold for each competitor in the cell, presumably due to territorial conflicts) then we 231 see a small decrease in the oscillation frequency in the former case (compare plots Fig. 3 232 with orange plot in Fig. 4A ), but a very different type of trajectory in the strong mutual 233 interference case (compare plots in Fig. 3 with orange plot in Fig. 4B ). 
We evaluated the effects of our agents moving on the total number of agents over time 236 for the following five strategy rules (note: the rules apply to staying in the current cell 237 or moving to one of 18 the cells within a radius of 2 hexagonal rings for all times steps 238 except t mod T f when all individuals must be back in their nest cells): 3. minimize movement costs (φ 1 = φ 2 = 0) 243 4. maximize an equally weighted combination of the above three (φ 1 = φ 2 = 1/3) 244 5. maximize an equally weighted combination of all three, but allow individuals to 245 switch colonies with an 80% probability when in the nest cell of a foreign colony 246 that is no more than 30% as large as the individual's current colony (p switch = 0.8, 247
The number of agents produced by an illustrative simulation for each of movement To illustrate the impact of mortality rates on population viability, we ran our baseline 253 scenario 15 times with the natural mortality increased from µ = 0.005 to µ = 0.02. The 254 times at which the population was extirpated in these 15 runs is given in the first row of 255 Number of agents N t (i.e., the agent population trajectory) are plotted for the baseline case except for the following modifications to movement behavior. Movement is driven by: territory size maximization (blue plots, two replicates when φ 1 = 0, φ 2 = 1 ); available resource maximization (green plots, two replicates when φ 1 = 1, φ 2 = 0); movement cost minimization (orange and yellow plots, two replicates of φ 1 = φ 2 = 0); and equal weightings of above three (dotted grey plot-the same as blue plot in Fig. 3 where φ 1 = φ 2 = 1/3).
individuals persists over time) [48] . In the latter case, the bimodal distribution is 267 essentially a long-tailed distribution, given that all stochastic population processes 268 ultimately go to zero, if zero is an absorbing state (which it is in our model since no new 269 infectious individuals are recruited from outside of our metapopulation) [77] (Fig. 6 ).
Our model is initially seeded for potential disease outbreaks in that one of the agents at 271 simulation initialization is in disease state E (exposed), while the remaining 349 are in 272 disease state S (susceptible). To set up potential pathogen transmission outbreak 273 scenarios requires that the transmission parameter be positive (i.e. β > 0). To explore 274 the nature of these bimodal distributions for our model, we simulated 15 instances each 275 of disease dynamics for the cases β = 0.01, 0.2, and 0.03. The amount of time it took 276 for the number of exposed and infected individuals to fall to zero in each of these cases 277 is represented in the histograms plotted in Fig. 6A . The agent dynamics in the 278 longest-lasting of these 45 runs is illustrated in Fig. 6B . In these simulations, we note 279 that the only effect of pathogens on host-population dynamics is through the 280 assumption that individuals in disease states E and I do not reproduce, and not through 281 disease-induced mortality (considered next).
October 1, 2019 10/28 
In standard SIR epidemic models, the virulence of a pathogen is assumed to be 284 captured by the size of the disease-induced mortality rate parameter [14] . In our model 285 this parameter is µ I ( Table 2) . We investigated the effects of increasing the value of this 286 virulence parameter in the context of a pathogen transmission rate of β = 0.05 (Table 2 ) 287 that leads to outbreaks that generally persist over our 2000 time step interval (cf. Lotka-Volterra-type population process iterated at a "slow" daily time scale. This study 340 found inter-alia that increasing predator efficiency by either increasing their perceptual 341 range or decreasing the number of prey refugia resulted in a coexistence region-an 342 equilibrium around which the prey and predatory populations oscillated-decreased for 343 both prey and predator, thereby increasing the risk of extinction. As in our model, the 344 second study included the interaction of both competition and predation. The 
One thread of the quantitative narrative that emerges from simulations of our model 354 is that competition causes the period of prey-predator oscillations to increase and be 355 dampened more rapidly, with this increase and dampening accentuated as colony 356 mixing increases. A second thread is that a "grass is greener syndrome" (i.e., movement 357 decisions are based purely on resource considerations) leads to increased stress in 
A second thread of the quantitative narrative that emerges from our simulations 367 relates to the effects of disease on population dynamics, for which our model provides 368 an appropriate formulation to address the questions of interest. One of these effects is 369 the impact of increasing pathogen transmission rates on the maintenance of an endemic 370 infection. No subclass of a population (e.g., infectious individuals or even the 371 population as a whole) can persist forever-both are bounded stochastic population 372 processes that are known to go extinct in a finite amount of time [74, 75] . This is amply 373 demonstrated in our simulations that consider the impacts of increasing pathogen 374 transmission rates. In Fig. 6A , we verify that our infection process produces the 375 expected U-shaped bimodal distributions of infectious individuals, though the breadth 376 of the distribution associated with the outbreak mode (as opposed to an early-fade-out 377 mode) increases with β. Indeed, for β = 0.05, once an outbreak occurs, it generally lasts 378 longer then 1000 time steps, as illustrated in Fig. 7 . This remains true as the virulence 379 of the pathogen increases from µ I = 0 (blue plots in Fig. 7 ) through µ I = 0.03 (orange 380 plots in Fig. 7 ) and µ ID = 0.1 (grey plots in Fig. 7 ) to µ I = 0.2 (yellow plots in Fig. 7 ). 381 What is clear from these simulations is that as virulence increases, the number of more precise than the level of the errors associated with the fit of models to data.
The model we present here has the potential to address a range of questions relating 403 to the ecology of consumer-resource interactions played out over spatially-structured 404 landscapes and impacted by movement and disease processes. Our model can also be 405 elaborated to address questions that include, for example, mating and genetic 406 structures, multispecies situations, environmental factors that exhibit seasonal variation, 407 and landscape structures, including individuals moving over real landscapes. Numerus 408 Model Builder has the facility to import landscape information from GIS databases that 409 can be easily extended to metapopulation settings [90]: thus our model can be readily 410 extended to ask questions about spatially-structured populations on real landscapes.
Of course, considerable interest exists in fitting models to data, especially in the 1. The population initially consists of N 0 agents; but over time, due to births and 425 deaths this number will change and be designated N t . 426 2. The landscape is a pixelated H γ × H δ hexagonal cellular array with a doughnut 427 topology. The index pair γ, δ refers to a particular cell in this array. To emphasize 428 that these indices refer to one entity (a particular cell), we tie them together using 429 October 1, 2019 14/28
All rights reserved. No reuse allowed without permission.
The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. . https://doi.org/10.1101/791400 doi: bioRxiv preprint a hat notation: viz., γ, δ. This is particularly useful when we use multiple 430 subscripts to refer to cells in the neighborhood of the cell γ, δ. The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. . https://doi.org/10.1101/791400 doi: bioRxiv preprint (d) a α, , = 4, 5, ... may be continuous state variables that measure the relative 475 size of individuals, their state of hunger, their state of emaciation when food 476 is in short supply, and so on. Here we only use two such variables and refer 477 to a α,4 interchangeably as the fitness or biomass variable and a α,5 as the 478 stress variable. distance any single move can be:
The total number of cells in this set is K = 1 + 6(1 + 2 + ... + r) = 1 + 3r + 3r 2 (one 497 center cell plus each hexagonal ring centered on this center cell ring has 6 cells more 498 then the its immediate inscribed ring: i.e., 1+6+12+...+6(r-1)+6r cells). We use the 499 notation γ, δ i ≡ i, i = 1, ..., K to index a renumbering of cells in BLOCK α (r) . One 500 renumbering scheme, for example, is to label the center cell γ, δ, occupied by individual 501 α, as γ, δ = γ, δ 1 , the cell to its immediate west as γ, δ + 1 = γ, δ 2 , then going 502 counter-clockwise until the last of the cells in RING α (1) has been labeled 7 (i.e., 503 γ − 1, δ + 1 = γ, δ 7 and moving on to the west most cell in RING α (2) as 8 and so on 504 until all cells in RING α (r) have been labeled.
The decision for agent α belonging colony to stay in its current cell or move to 506 some other cell in BLOCK α (r) is determined using the agent movement rule below that 507 relies on the following three measures: 508 Distance measure: Closer is better 509 For some decay parameter ε > 0, distance radius ν i , and maximum distance
represent the distance between the center cell and the i th cell in BLOCK α when this 512 cell is in RING α (ν i ). If
October 1, 2019 16/28
All rights reserved. No reuse allowed without permission.
The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. . https://doi.org/10.1101/791400 doi: bioRxiv preprint Comparative occupation-history measure: Prefer cells less used by other colonies 517 Under our renumbering c γ,δ i ,m+1 (t) is cell i's γ, δ's memory state with regard to 518 the occupation history of agents from colonies m = 1, ..., M in this cell. For cells 519 i = 2, ..., K, this quantity is based on a comparison of the largest occupation 520 history value (in cell i) of c γ,δ i ,m (t) for all m = 1, ..., M in comparison with the 521 occupation history value of agent α in cell i. Recalling that agent α is from colony 522 ) then, for i = 1, ...., K, First, we determine for all cells which individuals occupying each cell stay or move, and 531 then, we compute changes in the resource states of the cells, as well as the fitness that 532 individuals gain or lose from consuming resources due to movement activity. 
If y = 0 then X(t) = 0. Specifically, the individuals' fitness states a α,4 (t − 1), 548 α = 1, ..., N , are updated for a maximum fitness value a max α,4 , a fitness decay factor 549 October 1, 2019 17/28
All rights reserved. No reuse allowed without permission.
The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. . https://doi.org/10.1101/791400 doi: bioRxiv preprint ψ, and a biomass conversion parameter 0 < κ < 1 using 550 a α,4 (t) = e −ψ a α,4 (t − 1) + κX(t − 1) max 0, 1 − a α,4 (t − 1) a max α,4
and the cell γ, δ resource state for resource-intrinsic-growth-rate parameter r > 0, 551 reservoir parameter g ≥ 0 and saturation parameter s > 0 is updated, by first
and then using the equation
MOVE dynamics Individual fitness updating 555
If an individual α moves out of a cell at time t − 1, then the individual's fitness 556 (or biomass) decays at a rate νψ > 0, where ψ is the decay rate factor introduced 557 in the STAY dynamics section and ν > 0 is the fitness cost of moving relative to 558 not moving; i.e., 559 a α,4 (t) = e −νψ a α,4 (t − 1)
Stress dynamics Individual not meeting daily requirements 560 We model stress dynamics using a variables a α,5 (t) for the a = 1, ..., N agents. We 561 note that a α,5 (t) ≥ 0, such that a α,5 (t) = 0 implies the individual is unstressed 562 with stress increasing as a α,5 (t) increases. We assume that without additional 563 stress input, the a α,5 (t) relaxes back to zero at a rate c z . However, if an 564 individual is subject to an additional stress z α (t) over the interval [t, t + 1] then 565 its new stress level at time t will be 566 a α,5 (t) = max{0, (1 − c z )a α,5 (t − 1) + z α (t − 1)}
To calculate the amount of stress an individual is subject to in each time interval, 567 we assume that when it moves (i.e. does not take in any resources) then it has a 568 resource deficit of X * type (i.e., a set of input parameter values subscripted by type, 569 where "type" indicates that these deficits may vary by species, sex, or age, etc.). 570 In this case we assume, dropping the type designation (since we make this 571 parameter the same for both sexes, all disease states, and we have no incorporated 572 age structure), that 573 MOVES :
where c m > 0 is a conversion constant that depends on the units used to measure 574 resources. On the other hand, if an individual gets to stay in the cell over time
[t, t + 1], and there are y individuals (including itself) that stay to exploit 576 resources in the cell during this time interval, the amount of resource that the 577 individual extracts, from Eq. 6, is X(t − 1)/y. We now assume that the extent to 578 which this value falls short of the resource deficit value X * is the amount of stress 579 incurred over [t, t + 1] multiplied by the conversion constant: i.e., 580 STAYS :
Note the the above covers all individuals that stay whether or not they reproduce. 581
October 1, 2019 18/28
All rights reserved. No reuse allowed without permission.
The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. 
6.4 Epidemiology and Deaths
The epidemiological component is essentially an S (susceptible), E (exposed but not yet 589 infectious), I (infectious), V (recovered with immunity) and D (dead) model [26] . We 590 use the value of a α,2 to denote this state and use the following rules to compute whether 591 or not individuals in states S, E, I, and V respectively transition to states E, I, V, S and 592 D in terms of "transition rate parameters" γ E > 0, γ I > 0, γ V > 0, γ S > 0 and γ D ≥ 0. 593 We assume a basic death rate over the interval [t, t + 1) µ 0 > 0 that increases with 594 stress at rate that is proportional to the stress level a α,5 (t), with a constant of 595 proportionality given by c s > 0. In this case:
for all individuals in diseases states S, E, I and V. For individuals in disease state I, we 597 assume an additional disease induce mortality rate µ I c γ,δ,1 (t) (where for relatively high 598 mortality diseases µ I >> µ 0 ) so that for individuals in I, where we add the index I to 599 distinguish it from the rate we have in Eq. 15
Cell Infectiousness Pathogen density in each cell 
If susceptible, individuals also have a probability of dying over the same time 612 interval at a rate (or force of risk) that is proportional to their stress level a α,5 (t) 613 then, in essences, we are assuming that the transition rate out of then using a There are several ways to deal with emigration. A relatively simple approach is for 629 an individual to make a decision to join a colony, when it enters a colony cell and Here is a very simple approach that we employ in our simulation, based on the idea 634 that if a colony consists of a very few individuals, then competition for resources is less 635 intense in the neighborhood of this colony. In rule articulated below, #m refers to the 636 number of individuals in colony m:
Rule: An individual from colony m , currently in the nest cell of colony m, will switch to colony m with probability p switch whenever #m /#m < ρ crit (20)
All individuals in colonies that do not move have an opportunity to reproduce at that 639 start of each new fast cycle (i.e., when t mod T f = 0). In particular, any individual who 640 is in disease state S or V, and whose fitness value exceeds b min will not move in the next 641 time step, but will instead give rise to a new individual. The fitness/biomass value of 642 this reproducing individual will drop (parent) and a newborn will be created with 643 updated fitnesses given by 644 If t mod T f = 0 and a α,4 (t) > b min then a α,4 (t + 1) = φ parent a α,4 (t) parent fitness a α ,4 (t + 1) = φ newborn a α,4 (t) newborn fitness
Note that the newly reproduced individual, α , will belong to the same colony. In 645 addition, we must have φ parent + φ newborn < 1, where the shortfall of this sum from 1 is 646 a cost of reproduction. The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. 
Here we provide some of the key details not included in previous publications [1, 2] regarding the construction, using the Numerus Model Builder platform, of the agent-based model presented in the main text. Numerus Model Builder (NMB) employs NovaScript, which is embedded in, and extends, Javascript. The NovaScript interpreter is an extension of the ECMA 1.7 Javascript standard. The full range of the Javascript language is available to the NovaScript programmer for specifying the computations required by his or her simulation. It includes facilities for specifying simulations visually, using stock and flow diagrams (familiar to programmers of Stella and Vensim) and other visual tools unique to NMB. Simulations are scoped out using such visual schematic diagrams with equation and other procedural details entered into appropriate windows [1] , or textually, via NovaScript. We will refer to the former as a diagram specification; the latter will be referred to as a code specification.
NMB is highly modularized due to: 1) the creation of dynamic agent "Capsules" that interact with their environments through input/output interfaces (more below) and 2) allowing these agents to move over a heterogeneous resource landscape. Movement can either be on a Cartesian plane or from one cell to another on a rectangular or hexagonal array of specifiable dimension [1] . Our model moves agents over hexagonal arrays of variable and dynamic resource cells and was designed to address questions regarding agent and colony populations dynamics under different movement and disease scenarios.
Simulations are built out of objects, called Components. Among the component types are Primitive Components, Simulators, Displays, and Controls. The primitive components consist of Stocks, Variables, Sequences, Flows, and Terms. Stocks, Variables and Sequences are used to represent the state of a running simulation. The Stock component may be attached to one or more Flows. Each Flow specifies some change in the current value of the Stock. A Variable is similar, only it is not attached to any Flow; rather its change is determined by a derivative contained in the Prime field. Sequences are similar to variables, except that they are discrete, and change is indicated by a Next field, directly determining the value of the sequence in the next time interval. Flows and Terms both have Exp fields containing their expressions. As mentioned above, Flows affect the value on the Stocks to which they are attached. A Term is used to compute a value using current State values (in Stella, what Numerus Model Builder calls a Term is referred to as a Converter.)
This model is formulated as a set of agents moving over a cellular array. Therefore, as described in our presentation, we require 3 Capsule types: the Cell, Agent, and sirTerrM. (Refer to Sections 3.1, 3.2, and 4 for further detail on each Capsule type.)
A Numerus model is structured using elements called Simulators. Here is a description of the Simulators used in our model. 1 All rights reserved. No reuse allowed without permission.
The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. . https://doi.org/10.1101/791400 doi: bioRxiv preprint Simulators. The term-of-art Simulator is used by Numerus Model Builder to describe a container of interacting components. In a running simulation, a Simulator is set to an initial state. As the simulation progresses its next state is determined by its current state and by other simulators with which it may be communicating. The Capsule is the simplest Simulator, and may contain any of the components described in the previous section. The five other Simulator types are array-like aggregators comprised of Capsule elements. Each aggregator introduces new functionalities to their constituents, as described below.
Capsule. The role of the Capsule is to contain the components of a simulation and synchronize the progress of the computation. A Capsule holds instances of the primitive components, but may also contain other Capsules and other aggregator Simulators.
The top-level construct in any model is a Capsule.
A CellMatrix is a spatial array of individual Capsules, or Cells laid out in either a Cartesian lattice or hexagonal grid. Each Cell has a pair of coordinates and can query the CellMatrix to determine the other Cells in its neighborhood, with which it can exchange information. A CellMatrix can also provide an environment for agents to exist when combined with an AgentVector (see below).
In our model each cell contains resources (i.e., plants, fruits, seeds), can act as a nest site associated with a specified colony of agents, and can be occupied by one or more agents who either pass through in a single time period or remain for some time during which they exploit the dynamically changing (through both growth and extraction) resources.
AgentVector. An AgentVector contains a dynamic set of Capsules called Agents that can exist on some landscape. At any point in time an Agent has a location on that landscape, which will change if the Agent decides to move. Agent motion will generally either use a toroidal topology or reflect off the boundary like a billiard ball (other boundary effects can be implemented). The AgentVector helps Agents find nearby Agents with which they may interact. New Agents may be created and existing Agents may be removed during the lifetime of the simulation.
In our model each Agent has a biomass (a surrogate measure of the agent's individual fitness), a stress level, and a sex (determined at birth). Females may reproduce on regular returns back to their colonies. This works via the parent retaining the majority of the biomass, the offspring acquiring a minority of biomass, and some loss from the cost of the reproduction event itself. Our movement algorithm uses a toroidal topology in order to eliminate boundary effects.
A SimWorld combines a CellMatrix with an AgentVector to create an artificial environment in which the Agents of the AgentVector range over the landscape created by the CellMatrix. Consequently, in addition to interacting with each other, Agents may determine the Cell in which they are located and interact with that or nearby Cells.
Pictured below is the top level Capsule of our model, sirTerrM showing the SimWorld labeled NWorld, which models a set of agents moving over a hexagonal cellular array.
Other components in this Capsule are used to initialize the SimWorld and analyze and display results.
Numerus Model Builder also provides 2 additional Simulators for implementing a network spatial topology and using that topology as an agent landscape.
Stocks, Flows and Sequences. Traditional system dynamics modeling is centered on the stock-and-flow construct, whereby a stock, representing some dynamic model value, is updated by adding or subtracting the content of one or more flows (i.e respectively "flowing in or out" of the stock). In the simplest case, with a single flow flowing into a stock, the flow's value is the derivative of the stock's value over time. (When multiple flows are present, the derivative is found by summing the positive and negative flow values). The stock-flow model in system dynamics is especially apt for designing networks of stocks connected by flows that move values between the stocks.
Numerus fully supports the system dynamics paradigm, but adds several convenient modifications. A single Numerus Stock-Flow component may be substituted for a Stock with a single input Flow. This configuration can be particularly useful when modeling differential equations. Numerus also introduces a variation called Sequence, in which the Flow contains the Sequence's next value, rather than content to be added to or subtracted from the current value. Sequences do not offer the Runge-Kutta integration algorithms available to Stocks to reduce the error when modeling continuous processes; therefore they are most useful for discrete models.
Numerus models are built using drag-and-drop gestures that place components on a design canvas. In the figures below, Stocks and Sequences respectively use lime-green and lavender-pink rectangles, and Flows are represented as yellow circles with arrows connecting to their Stocks.
The sirTerrM model uses both Stocks and Sequences in the Agent Capsule to represent continuous and discrete elements of the model. The population initially consists of N 0 agents, but over time, due to births and deaths this number will change and be designated N t . To assign this, we go to Project >> Prelude.
Recall that the quantities c γ,δ,m (t), m = 1, ..., M , contain a fading memory of how many individuals from colony m have visited the cell c γ,δ up until time t. In our implementation these data are stored in an M -element array in the Sequence Cell Memory. This array is initialized with each slot set to 0. At each point in time first the current value of each slot is aged by a factor of e −η M (where η M is represented in the program by the parameter mem fade), and then the current population of the cell is distributed to the slots based on their nest of origin.
Note that cell Memory is referenced by an agent during the process of determining its next move. This computation is contained in the agent's move comp term. 6 All rights reserved. No reuse allowed without permission.
The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. . https://doi.org/10.1101/791400 doi: bioRxiv preprint
We want the color of a cell in our visualization to reflect properties of the cell. Each nest is assigned a unique color which displays unless the nest is empty, in which case it displays in gray. Otherwise the cell's color is computed to reflect the color of the nest of origin of the most number of visitors, or a neutral color if unvisited. This computation occurs in the Cell term cellColor.
Underlying all dynamical systems modeling of epidemiological outbreaks and endemic diseases are formulations based on the concept of an SEIR progression. Susceptible individuals in disease class S enter disease class E on exposure to a pathogen (i.e., infected but not yet infectious themselves). After a period of latency, individuals in class E then transfer into the class of infectious individuals, I, only to transfer to a recovered or removed class R. However, note that once mortality is included in the model, then disease class R becomes ambiguous because removed individuals now include both recovered and dead individuals. Therefore, we use disease class V for recovered (i.e., "V" for naturally vaccinated individuals that have "recovered with immunity") and D for dead. This SEIVD notation proves useful once SEIR processes are expanded to include births, recruitment, immigration, deaths, and emigration processes.
cell Infect: Each cell has a cell Infect Sequence representing the infectiousness of the cell at time t based on the number of infected individuals that have visited. We require a fade rate to account for an assumed decline in the infectiousness environment of the cell over time brought about by past visitors. If the fade rate is close to 0, this implies that an indirect transmission of pathogens via the cell's environment is of significance, whereas if the fade rate goes towards ∞, then this implies that direct contact is increasingly important for transmission. 7 All rights reserved. No reuse allowed without permission.
The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. . https://doi.org/10.1101/791400 doi: bioRxiv preprint
The third and final Cell state value is the resources it contains for nourishing the agents that visit. The formulae for determining resource dynamics involve both natural growth and agent consumption, and are discussed fully in the paper.
Disease Transition Terms: We include the 5 transition states as Terms: gamma S, gamma E, gamma I, gamma V, gamma D, all of which govern the transitions of the Disease Value State (refer to Section 3 Model Components). Note that gamma E, gamma I, and gamma V are constants derived from parameters. gamma S, which governs the transition from Susceptible to Exposed, depends on the value of cell infect (i.e. the infectiousness of the environment); and gamma D, which governs the transition to Death, depends in part on agent stress.
Determining movement is a computation that occurs in the Term move comp. Section 6.2 of the manuscript explains movement in great detail. For the purpose of the Supplementary document, we will focus on a few fundamental concepts that determined our choosing of the terms and states for this particular component.
At the start of each time interval [t, t + 1], we initially make a case for whether or not individual α = 1, ..., N remains in its current cell or moves to some other cell in the set BLOCK α (r), where r is some pre-selected positive integer that determines the furthest distance any single move can be.
We determined whether or not agent α belonging to colony would stay in its current cell or move to another one, based on either Distance Measure (var dist), Comparative 8 All rights reserved. No reuse allowed without permission.
The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. . https://doi.org/10.1101/791400 doi: bioRxiv preprint Resource Measure (var myResource), and Comparative Occupation-History Measure (var otherMaxOccupancy).
There is also a stochastic trade-off with the agent movement rules, which play a role in determining cell attractiveness values. 9 All rights reserved. No reuse allowed without permission.
The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. . https://doi.org/10.1101/791400 doi: bioRxiv preprint
The Agent Color component also exists in order for us to observe distinctions between agents. It is determined by the agent Term agentColor, with each agent given the color associated with its home nest.
A Fitness Sequence (defined in terms of the maximum resource extraction rate parameter) is also included in the model with the purpose of updating the stress state of individual agents. More specifically, the fitness of an individual is updated over the time interval[t−1, t] for the maximum fitness value, the fitness decay factor, and the biomass conversion values, all of which are broken down thoroughly in Section 6.3, Ecological Dynamics, of the manuscript. If an individual moves out of a cell at time t − 1, then the fitness is reduced by a fraction that is some multiple of the decay rate.
We model Stress Dynamics through the agent's Stress Stock, which contains the quantity a α,5 (t) for a = 1, ..., N , as described in Equation 11 of Section 6.3 in the paper. We note that the Stress component is initially given a random value between 0.5 and 1.
All rights reserved. No reuse allowed without permission.
The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. . https://doi.org/10.1101/791400 doi: bioRxiv preprint
This model assumes nothing about mating structures and male limitations; therefore, only females reproduce, given a particular probability at regular colony-return times, provided they have sufficient fitness and sufficiently low stress values. Individuals die at naturalmortality specified rates, as well as with an additional disease-induced-mortality rate during their infectious period. Note that, as demonstrated in the figure below, Reproduction is a Command that occurs only when an agent selects "reproduced" as its current action. According to the rules of the model, this can occur only when the agent is in its home nest, which recurs on a cyclic basis (see the agent Term what should i do for the rules governing this selection).
In our model, we incorporate the effect of pathogens on host population dynamics; therefore, individuals in disease states E and I do not reproduce. Individuals in disease state S or V, and whose fitness value exceeds b min will not move at the next time step, but instead will give rise to a new individual. Furthermore, newly reproduced individuals will belong to the same colony as their parents.
11 All rights reserved. No reuse allowed without permission.
The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. . https://doi.org/10.1101/791400 doi: bioRxiv preprint
The top-most level includes the SimWorld container NWorld to house the cells and agents defined by the latter two Capsules.
The Prelude contains the globally defined array nestPop that keeps track of the population of the 9 colonies used by the model. The Terms colony 0 through colony 8 each select a distinct slot of this array for inclusion in the bar graph Nest Population (see below). The locations of the nests are defined in the Term Nests using the Numerus Cell ID notation CY :X, where Y and X respectively indicate the row and column address of the cell. Nest locations are fed to the SimWorld through input pins to both its Agent and Cell constituents, since both need to be aware of these locations.
There are a total of 6 displays showing the state of the running model. The first is a visualization of model activity generated by the NWorld SimWorld. The second and third 12 All rights reserved. No reuse allowed without permission.
The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. . https://doi.org/10.1101/791400 doi: bioRxiv preprint are, respectively, the bar graph mentioned above showing the current colony populations, and line graphs tabulating the current disease state of the agents. The final three displays provide statistical information across the agent and cell populations for Stress and Fitness (agent); and Resource (cell). The Stats plug-in is used to create graphs showing the mean and mean ± standard deviation of each of these quantities.
The tables below provide a translation between the notation used in the text and that employed in the model. 
