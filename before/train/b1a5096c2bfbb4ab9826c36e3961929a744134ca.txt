Generation intervals, defined as the time between when an individual is infected and when 14 that individual infects another person, link two key quantities that describe an epidemic: 15 the reproductive number, R, and the rate of exponential growth, r. Generation intervals 16 are often measured through contact tracing by identifying who infected whom. We study 17 how observed intervals differ from "intrinsic" intervals that could be estimated by tracing 18 individual-level infectiousness, and identify both spatial and temporal effects, including cen-19 soring (due to observation time), and the effects of susceptible depletion at various spatial 20 scales. Early in an epidemic, we expect the variation in the observed generation intervals to 21 be mainly driven by the censoring and the population structure near the source of disease 22 spread; therefore, we predict that correcting observed intervals for the effect of temporal 23 censoring but not for spatial effects will provide a spatially informed "effective" generation-24 interval distribution, which will correctly link r and R. We develop and test statistical 25 methods for temporal corrections of generation intervals, and confirm our prediction using 26 individual-based simulations on an empirical network.
An epidemic can be characterized by the exponential growth rate, r, and the reproductive 32 number, R. The reproductive number, defined as the average number of secondary cases 33 arising from a primary case, is of particular interest as it provides information about the 34 final size of an epidemic (1; 2). However, estimating the reproductive number directly from 35 disease natural history requires detailed knowledge which is not often available, particularly 36 early in an outbreak (3). Instead, the reproductive number can be indirectly estimated from 37 the exponential growth rate, which can be estimated from incidence data (4; 5; 6; 7; 8).
These two quantities are linked by generation-interval distributions (9; 10; 11; 12; 13). 39 A generation interval is defined as the time between when a person becomes infected and 40 when that person infects another person (10). Due to individual variation in infection time, 41 the observed generation-interval distribution can change depending on when and how it is 42 measured (10; 14; 15; 16). There are important distinctions to be made when estimating 43 generation intervals: intrinsic generation intervals measure the infectiousness of an infected 44 individual, while observed generation intervals refer to the time between actual infection 45 events. 46 While the intrinsic generation-interval distribution is often assumed to be fixed, the 47 shape of the observed generation-interval distribution depends on when and how intervals 48 are measured (14; 15; 17; 16; 18). When an epidemic is growing exponentially, as often occurs 49 near the beginning of an outbreak, the number of newly infected individuals will be large 50 relative to the number infected earlier on. A susceptible individual is thus relatively more 51 likely to be infected by a newly infected individual. Thus, "backward" generation intervals 52
(which look at a cohort of individuals, and ask when their infectors were infected) will be 53 shorter on average than intrinsic generation intervals -the converse is true when an epidemic 54 is subsiding (15; 16; 18).
In practice, generation intervals are often measured by aggregating available information 56 from contact tracing. While an epidemic is ongoing, these measurements are "censored": we 57 don't know what happens after the observation time. These censored intervals are similar 58 to backward intervals: there is a bias towards observing shorter intervals, which are more 59 likely to have concluded by the observation time.
Realized generation intervals are also affected by spatial structure. In a population 61 that does not mix homogeneously, susceptibility will tend to decrease more quickly in the 62 neighbourhood of infected individuals than in the general population. This means that 63 contacts made late in an individual's infection are more likely to be ineffective due to contacts 64 that were made earlier (because the contactee may have been infected already) As a result, 65 realized generation intervals will have shorter mean than the intrinsic generation-interval 66 distribution. This perspective allows us to reinterpret the finding of (19) that, given an 67 intrinsic generation interval and an observed growth rate, the reproductive number on various 68 network structures is always smaller on a network than would be predicted from homogeneous 69 mixing. These observations allow us to make the following prediction: removing the time-70 censoring bias from observed generation intervals will yield a spatially corrected "effective" 71 distribution that contains information about the population structure and will allow us to 72 2
correctly infer the reproductive number from the exponential growth rate.
In this study, we explore spatiotemporal variation in generation intervals measured 74 through contact tracing. We extend previous frameworks to study how the censored generation-75 interval distributions change over time and compare this distribution with the backward 76 generation-interval distribution. We classify spatial effects on generation intervals into three 77 levels (egocentric, local, and global) and discuss how they affect observed generation-interval 78 distributions. Finally, we compare two methods for accounting for temporal bias and test 79 our prediction using simulations. course of infection (e.g., duration of latent and infectious periods) and the level of infectious-88 ness, which can depend both on biological infectiousness as well as contact patterns. 89 Assuming that the individual properties are independent of risk of infection, the population-90 level kernel is given by integrating over these individual variations:
The population-level kernel describes the rate at which secondary infections are expected 92 to be caused by an an infected individual, on average. where f (a) represents a probability 93 density over a (possibly multi-dimensional) aspect space. 94 Assuming that a population mixes homogeneously, we can write:
where R 0 = K(τ )dτ is the basic reproductive number (the expected number of secondary 96 cases caused by a randomly chosen infectious individual in a fully susceptible population), 97 and g(τ ) is the expected time distribution of those cases (the intrinsic generation-interval 98 distribution).
In a homogeneously mixing population, current disease incidence at time t, i(t), is the 100 product of the current infectiousness of individuals infected in the past and the current 101 proportion of the population susceptible, S(t).
102
where R = S(t)R 0 is the effective reproductive number. This model, referred to as the The density of new infections occurring at time t caused by infectors who were infected 116 at time t − τ is given by
4 . CC-BY-NC-ND 4.0 International license is made available under a The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. It . https://doi.org/10.1101/683326 doi: bioRxiv preprint tion of infection that occurred τ time units before the reference time t and is proportional 119 to i(t − τ )g(τ ). The censored generation-interval distribution, c t (τ ), describes all cohorts 120 infected at time s < t; thus, the censored generation-interval distribution is just the average 121 of the backward distributions of these cohorts, weighted by incidence:
For a single outbreak, the observed mean generation interval through contact tracing 123 will always be shorter than the mean intrinsic generation interval ( Figure 2 ). There are two 124 reasons for this phenomenon. First, longer generation intervals are more likely to be missed 125 due to right censoring (and short generation intervals are more likely to be observed). In 126 particular, when an epidemic is growing exponentially (i(t) = i(0) exp(rt)), the initial cen-127 sored (or backward) generation-interval distribution is just the intrinsic generation-interval 128 distribution discounted by the rate of exponential growth (18):
A deterministic simulation confirms that the censored generation-interval distribution has 130 the same mean as the backward generation-interval distribution during this period ( Figure 2 ).
Second, the decreasing number of susceptibles over the course of an epidemic makes long 132 infections less likely to occur (16). Overall, we expect naively using the observed generation-133 interval distribution, to underestimate the reproductive number. Infected individuals may contact the same susceptible individual multiple times, but only 136 the first effective contact gives rise to infection in a given individual (after this, they are no 137 longer susceptible). Therefore, we expect realized generation intervals to be shorter than 138 intrinsic generation intervals, on average, in a limited contact network.
To explore the effect of multiple contacts on realized generation intervals, we first consider 140 the infection process from an "egocentric" point of view, taking into account infectious 141 contacts made by a single infector. We define the egocentric kernel as the rate at which 142 secondary infections are realized by a single primary case with aspect a in the absence of 143 other infectors:
where k(τ ; a) is the individual-level intrinsic kernel and e −δ(a) τ 0 k(s;a)ds is the probability that 145 a susceptible acquaintance has not yet been contacted by a particular infected individual.
The dilution term, δ(a), models how contacts are distributed among susceptible acquain-147 tances.
Throughout this paper, we assume that there is a constant per-pair contact rate λ. In Figure 2 : Temporal variation in the mean observed generation interval. A deterministic Susceptible-Exposed-Infectious-Recovered (SEIR) model was simulated using Ebola-like parameters (20): mean latent period 1/σ = 5 days, mean infectious period 1/γ = 11.4 days, and the basic reproductive number R 0 = 2. The backward and the censored mean generation interval were calculated over the course of an epidemic. The dotted horizontal line represents the mean intrinsic generation interval.
6 . CC-BY-NC-ND 4.0 International license is made available under a The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. It . https://doi.org/10.1101/683326 doi: bioRxiv preprint the number of acquaintances: δ(a) = 1/N (a). This assumption can be relaxed by allowing 152 for asymmetry (19) or heterogeneity (27; 28) in contact rates; for brevity, we do not pursue 153 these directions here.
The population-level egocentric kernel is found by integrating over individual variations:
(19) used this same kernel (also assuming a constant per-pair contact rate) to study the 157 effect of network structure on the estimate of reproductive number. The population-level 158 egocentric generation-interval distribution is:
The population-level egocentric generation-interval distribution describes the distribution of :
As the egocentric distribution always has a shorter mean than the intrinsic distribution,
will always be smaller than R estimated from the intrinsic distribution; this generation- 
For example, consider a susceptible-exposed-infected-recovered (SEIR) model, which 169 assumes that latent and infectious periods are exponentially distributed. The intrinsic 170 generation-interval distribution that corresponds to this model can be written as (29):
where 1/σ and 1/γ are mean latent and infectious periods, respectively. Assuming a constant 172 per-pair contact rate of λ for any pair, we obtain the following egocentric generation-interval 173 distribution:
In this case, with fixed infectiousness during the infection period, the effect of accounting The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. It . https://doi.org/10.1101/683326 doi: bioRxiv preprint using this distribution to link r and R using the Euler-Lotka equation is unrealistic because 181 it requires that we know the per-pair contact rate. Instead, the per-pair contact rate can be 182 inferred from the growth rate r, assuming that mean and variance of the degree distribution The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. It . https://doi.org/10.1101/683326 doi: bioRxiv preprint times that occurs on most networks, however. Generation intervals are also shortened by 193 indirect connections: a susceptible individual can be infected through another route before 194 the focal individual makes infectious contacts. Simulations on a small homogeneous network 195 confirm this additional effect (Fig. 3, right panel) . 196 In general, spatial reduction in the mean generation interval can be viewed as an effect Since the right-censoring effect is a sampling bias, we typically want to correct for it.
In contrast, spatial effects have the same effect on how the epidemic spreads as they do on 219 observed generation intervals. We therefore expect that starting from observed generation 220 intervals and correcting for the right-censoring effect, will allow us to estimate an "effective" 221 generation interval that accurately reflects dynamics of spread. When temporal correction 222 is performed early in an outbreak, during the exponential growth phase, the effective distri-223 bution should incorporate egocentric and local spatial effects but not the global effects; we 224 expect this distribution to correctly link r and R. We will call the temporally corrected ef-225 fective generation-interval distribution g eff (τ ). In a large homogeneously mixing population, Here, we investigate two methods for correcting for temporal bias in contact-tracing data 230 (see Methods for details). We refer to the first method as the population-level method as Using the observed generation-interval distributions (based on the first 1000 generation intervals) without correcting for right-censoring severely underestimates the reproductive number. Similarly, using the intrinsic generation-interval distribution overestimates the reproductive number because it fails to account for local spatial effects; the egocentric distribution corrects for this only partially. Both population-level and individual-level methods provide estimates of reproductive number that are consistent with the empirical estimates, which we define as the average number of secondary cases generated by the first 100 infected individuals, but the individual-level method is more precise. Boxplots are generated using 100 stochastic simulations of the SEIR model on an empirical network using Ebola-like parameters (20): mean latent period 1/σ = 5 days and mean infectious period 1/γ = 11.4 days. Per-pair contact rate λ = 0.08 days −1 is chosen to be sufficiently high such that differences are clear.
. CC-BY-NC-ND 4.0 International license is made available under a The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. It . https://doi.org/10.1101/683326 doi: bioRxiv preprint epidemic is growing exponentially, right-censoring causes the observed generation interval to 233 be discounted by the exponential growth rate (7); hence, we can "undo" the censoring by 234 exponentially weighting the observed generation-interval distribution (17; 15; 18):
where r is the exponential growth rate. 236 We refer to the second method as the individual-level method because it relies on indi- whereas changes due to spatial or network structure reflect the dynamics of the outbreak. We compare two methods for estimating the effective generation-interval distribution and 298 assume that the effective generation-interval distribution follows a gamma distribution. The 299 gamma approximation of the generation interval distribution has been widely used due to its 300 simplicity (31; 6; 32; 33; 34); we previously thought that summarizing the entire distribution 301 with two moments (mean and variance) is sufficient to understand the role of generation-302 interval distributions in linking r and R (13). However, further investigation of our methods 303 suggests that making a wrong distributional assumption can lead to biased estimates of 304 the mean and CV of a generation-interval distribution (Appendix A.3), even though the 305 gamma distribution "looks" indistinguishable from the shape of the intrinsic generation-306 interval distribution (derived from the SEIR model). These results are particularly alarming population structure can lead to subexponential growth (35; 36; 37; 38; 39; 40); we therefore expect our simulations on an empirical network to be better characterized by subexponential 314 growth models (40). However, our simulations suggest that the initial exponential growth 315 assumption still provides a viable approach for estimating the reproductive number.
Contact tracing provides an effective way of collecting epidemiological data and control- The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. It . https://doi.org/10.1101/683326 doi: bioRxiv preprint
dI n dt = n I γ(I n−1 I n ) for n = 2, 3, . . . , n I
where S is the number of susceptible individuals, E m is the number of exposed individuals in distribution. Assume that latent and infectious periods are exponentially distributed with 379 mean 1/σ and 1/γ, respectively. Assuming a constant per-pair contact rate of λ for any pair, 380 the egocentric generation-interval distribution can be written:
Substituting into (11), we get
where r is the exponential growth rate. Alternatively, the reproductive number can be 383 expressed based on the degree distribution (mean µ and variance σ 2 ) of a network:
where κ = σ 2 /µ + µ − 1, referred to as the mean degree excess (52), describes the expected 385 number of susceptible individuals that an average infected individual will encounter early in 386 an outbreak. Combining the two equations, we get
which completes the relationship between the growth rate and the egocentric reproductive The Population-level method estimates the effective generation-interval distribution by 392 reversing the inverse exponential weighting in the observed generation-interval distribution:
where s i,j is the observed generation interval between infector j and infectee i, and θ is a (vec-406 tor) parameter of the generation-interval distribution g (and the corresponding cumulative 407 distribution function G eff ).
The likelihood of the non-homogeneous poisson process can be written as:
where N is the total number of infected individuals. Here, we estimate parameters R and θ We estimate the exponential growth rate r of an epidemic from daily incidence by modeling 416 the cumulative incidence c(t) with a logistic function (8). Fitting directly to cumulative 417 incidence can lead to overly confident results (55); instead we fit interval incidence x(t) = 418 c(t + ∆t) − c(t), where ∆t is 1 day, to daily incidence, assuming that daily incidence follows 419 a negative binomial distribution. We estimate the logistic parameters r, K, c 0 , and θ by 420 maximum likelihood. Fitting time window is defined from the last trough before the peak 421 of an epidemic to the first day after the peak of an epidemic. The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. It . https://doi.org/10.1101/683326 doi: bioRxiv preprint
